{"version":3,"sources":["components/layout/Heading/index.tsx","components/layout/Heading/index.module.scss","routes/safe/components/Apps/components/PermissionCheckbox.tsx","routes/safe/components/Settings/SafeAppsPermissions/index.tsx"],"names":["cx","classNames","bind","styles","Heading","props","align","children","className","color","margin","tag","testId","truncate","rest","classes","capitalize","undefined","React","module","exports","StyledFormControlLabel","styled","FormControlLabel","theme","colors","inputDisabled","PermissionsCheckbox","label","checked","onChange","name","control","StyledContainer","Block","lg","StyledPermissionsCard","Grid","grey400","StyledPermissionsCardBody","StyledPermissionsCardFooter","StyledSafeAppInfo","StyledLink","Link","SafeAppsPermissions","useAppList","isLoading","allApps","useSafePermissions","safePermissions","permissions","updateSafePermission","updatePermission","removeSafePermissions","removePermissions","isUserRestricted","useBrowserPermissions","browserPermissions","updateBrowserPermission","removeBrowserPermissions","domains","useMemo","mergedPermissionsSet","Set","Object","keys","concat","Array","from","updateAllPermissions","useCallback","origin","selected","length","map","capability","parentCapability","feature","handleAllowAll","event","preventDefault","handleClearAll","handleRemoveApp","appNames","reduce","acc","app","url","size","domain","item","container","xs","sm","strong","caveats","xl","SAFE_PERMISSIONS_TEXTS","displayName","_","handleSafePermissionsChange","status","toString","BROWSER_PERMISSIONS_TEXTS","handleBrowserPermissionsChange","PermissionStatus","GRANTED","justifyContent","href","onClick","type","tooltip"],"mappings":"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","file":"static/js/56.81e34e58.chunk.js","sourcesContent":["import classNames from 'classnames/bind'\nimport * as React from 'react'\n\nimport styles from './index.module.scss'\n\nimport { capitalize } from 'src/utils/css'\n\nconst cx = classNames.bind(styles)\n\nconst Heading = (props) => {\n  const { align, children, className = '', color, margin, tag, testId, truncate, ...rest } = props\n\n  const classes = cx(className, 'heading', align, tag, margin ? capitalize(margin, 'margin') : undefined, color, {\n    truncate,\n  })\n\n  return React.createElement(tag, { ...rest, className: classes, 'data-testid': testId || '' }, children)\n}\n\nexport default Heading\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Heading_heading__3Wz9P\",\"h1\":\"Heading_h1__MXfCA\",\"h2\":\"Heading_h2__3X6Ts\",\"h3\":\"Heading_h3__1k2fD\",\"h4\":\"Heading_h4__1YCmR\",\"center\":\"Heading_center__28MHY\",\"right\":\"Heading_right__1fQM1\",\"truncate\":\"Heading_truncate__2Lq93\",\"marginSm\":\"Heading_marginSm__13YwX\",\"marginMd\":\"Heading_marginMd__2AnZN\",\"marginLg\":\"Heading_marginLg__2ZfEq\",\"marginXl\":\"Heading_marginXl__3RHt7\",\"soft\":\"Heading_soft__2Zu43\",\"medium\":\"Heading_medium__2X8Z-\",\"dark\":\"Heading_dark__Ds2QB\",\"fancy\":\"Heading_fancy__1Wx6l\",\"warning\":\"Heading_warning__2lrZC\",\"primary\":\"Heading_primary__2hOk2\",\"secondary\":\"Heading_secondary__37lKs\",\"disabled\":\"Heading_disabled__30DjG\",\"error\":\"Heading_error__t5ujr\",\"white\":\"Heading_white__2gkIK\"};","import styled from 'styled-components'\nimport { Checkbox, FormControlLabel } from '@material-ui/core'\n\ntype PermissionsCheckboxProps = {\n  label: string\n  name: string\n  checked: boolean\n  onChange: (event: React.ChangeEvent<HTMLInputElement>, checked: boolean) => void\n}\n\nconst PermissionsCheckbox = ({ label, checked, onChange, name }: PermissionsCheckboxProps): React.ReactElement => (\n  <StyledFormControlLabel control={<Checkbox checked={checked} onChange={onChange} name={name} />} label={label} />\n)\n\nconst StyledFormControlLabel = styled(FormControlLabel)`\n  flex: 1;\n  .MuiIconButton-root:not(.Mui-checked) {\n    color: ${({ theme }) => theme.colors.inputDisabled};\n  }\n`\nexport default PermissionsCheckbox\n","import { ReactElement, useCallback, useMemo } from 'react'\nimport styled from 'styled-components'\nimport { Grid } from '@material-ui/core'\nimport { Text, Link, Icon } from '@gnosis.pm/safe-react-components'\n\nimport Block from 'src/components/layout/Block'\nimport { grey400, lg } from 'src/theme/variables'\nimport Heading from 'src/components/layout/Heading'\nimport {\n  useSafePermissions,\n  useBrowserPermissions,\n  SAFE_PERMISSIONS_TEXTS,\n  BROWSER_PERMISSIONS_TEXTS,\n} from 'src/routes/safe/components/Apps/hooks/permissions'\nimport { AllowedFeatures, PermissionStatus } from 'src/routes/safe/components/Apps/types'\nimport PermissionsCheckbox from 'src/routes/safe/components/Apps/components/PermissionCheckbox'\nimport { useAppList } from '../../Apps/hooks/appList/useAppList'\n\nconst SafeAppsPermissions = (): ReactElement => {\n  const { isLoading, allApps } = useAppList()\n  const {\n    permissions: safePermissions,\n    updatePermission: updateSafePermission,\n    removePermissions: removeSafePermissions,\n    isUserRestricted,\n  } = useSafePermissions()\n  const {\n    permissions: browserPermissions,\n    updatePermission: updateBrowserPermission,\n    removePermissions: removeBrowserPermissions,\n  } = useBrowserPermissions()\n  const domains = useMemo(() => {\n    const mergedPermissionsSet = new Set(Object.keys(browserPermissions).concat(Object.keys(safePermissions)))\n\n    return Array.from(mergedPermissionsSet)\n  }, [safePermissions, browserPermissions])\n\n  const handleSafePermissionsChange = (origin: string, capability: string, checked: boolean) =>\n    updateSafePermission(origin, [{ capability, selected: checked }])\n\n  const handleBrowserPermissionsChange = (origin: string, feature: AllowedFeatures, checked: boolean) =>\n    updateBrowserPermission(origin, [{ feature, selected: checked }])\n\n  const updateAllPermissions = useCallback(\n    (origin: string, selected: boolean) => {\n      if (safePermissions[origin]?.length)\n        updateSafePermission(\n          origin,\n          safePermissions[origin].map(({ parentCapability }) => ({ capability: parentCapability, selected })),\n        )\n\n      if (browserPermissions[origin]?.length)\n        updateBrowserPermission(\n          origin,\n          browserPermissions[origin].map(({ feature }) => ({ feature, selected })),\n        )\n    },\n    [browserPermissions, safePermissions, updateBrowserPermission, updateSafePermission],\n  )\n\n  const handleAllowAll = useCallback(\n    (event: React.MouseEvent, origin: string) => {\n      event.preventDefault()\n      updateAllPermissions(origin, true)\n    },\n    [updateAllPermissions],\n  )\n\n  const handleClearAll = useCallback(\n    (event: React.MouseEvent, origin: string) => {\n      event.preventDefault()\n      updateAllPermissions(origin, false)\n    },\n    [updateAllPermissions],\n  )\n\n  const handleRemoveApp = useCallback(\n    (event: React.MouseEvent, origin: string) => {\n      event.preventDefault()\n      removeSafePermissions(origin)\n      removeBrowserPermissions(origin)\n    },\n    [removeBrowserPermissions, removeSafePermissions],\n  )\n\n  const appNames = useMemo(() => {\n    const appNames = allApps.reduce((acc, app) => {\n      acc[app.url] = app.name\n      return acc\n    }, {})\n\n    return appNames\n  }, [allApps])\n\n  if (isLoading) {\n    return <div />\n  }\n\n  return (\n    <StyledContainer>\n      <Heading tag=\"h2\">Safe Apps Permissions</Heading>\n      <br />\n      {!domains.length && <Text size=\"lg\">There are no Safe Apps using permissions</Text>}\n      {domains.map((domain) => (\n        <StyledPermissionsCard item key={domain}>\n          <StyledPermissionsCardBody container>\n            <StyledSafeAppInfo item xs={12} sm={5}>\n              <Text size=\"xl\" strong>\n                {appNames[domain]}\n              </Text>\n              <Text size=\"lg\">{domain}</Text>\n            </StyledSafeAppInfo>\n            <Grid container item xs={12} sm={7}>\n              {safePermissions[domain]?.map(({ parentCapability, caveats }) => {\n                return (\n                  <Grid key={parentCapability} item xs={12} sm={6} lg={4} xl={3}>\n                    <PermissionsCheckbox\n                      name={parentCapability}\n                      label={SAFE_PERMISSIONS_TEXTS[parentCapability].displayName}\n                      onChange={(_, checked: boolean) => handleSafePermissionsChange(domain, parentCapability, checked)}\n                      checked={!isUserRestricted(caveats)}\n                    />\n                  </Grid>\n                )\n              })}\n              {browserPermissions[domain]?.map(({ feature, status }) => {\n                return (\n                  <Grid key={feature} item xs={12} sm={6} lg={4} xl={3}>\n                    <PermissionsCheckbox\n                      name={feature.toString()}\n                      label={BROWSER_PERMISSIONS_TEXTS[feature].displayName}\n                      onChange={(_, checked: boolean) => handleBrowserPermissionsChange(domain, feature, checked)}\n                      checked={status === PermissionStatus.GRANTED ? true : false}\n                    />\n                  </Grid>\n                )\n              })}\n            </Grid>\n          </StyledPermissionsCardBody>\n          <StyledPermissionsCardFooter container item justifyContent=\"flex-end\">\n            <StyledLink href=\"#\" size=\"lg\" onClick={(event) => handleAllowAll(event, domain)}>\n              Allow all\n            </StyledLink>\n            <StyledLink href=\"#\" color=\"error\" size=\"lg\" onClick={(event) => handleClearAll(event, domain)}>\n              Clear all\n            </StyledLink>\n            <StyledLink href=\"#\" color=\"error\" size=\"lg\" onClick={(event) => handleRemoveApp(event, domain)}>\n              <Icon size=\"sm\" type=\"delete\" color=\"error\" tooltip=\"Remove app permissions\" />\n            </StyledLink>\n          </StyledPermissionsCardFooter>\n        </StyledPermissionsCard>\n      ))}\n    </StyledContainer>\n  )\n}\n\nconst StyledContainer = styled(Block)`\n  padding: ${lg};\n`\n\nconst StyledPermissionsCard = styled(Grid)`\n  border: 2px solid ${grey400};\n  border-radius: 8px;\n  margin-bottom: 16px;\n`\n\nconst StyledPermissionsCardBody = styled(Grid)`\n  padding: 15px 24px;\n  border-bottom: 2px solid ${grey400};\n`\n\nconst StyledPermissionsCardFooter = styled(Grid)`\n  padding: 12px 24px;\n`\n\nconst StyledSafeAppInfo = styled(Grid)`\n  padding: 9px 0;\n`\n\nconst StyledLink = styled(Link)`\n  text-decoration: none;\n  margin-left: 16px;\n`\n\nexport default SafeAppsPermissions\n"],"sourceRoot":""}