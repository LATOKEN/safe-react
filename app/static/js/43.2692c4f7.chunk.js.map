{"version":3,"sources":["components/Divider/index.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/styles.tsx","routes/safe/components/Apps/components/SafeAppCard/SafeAppSkeleton.tsx","routes/safe/components/Apps/components/SafeAppCard/SafeAppCard.tsx","utils/clipboard.ts","routes/safe/components/Apps/components/SecurityFeedbackModal/SecurityFeedbackDomain.tsx","routes/safe/components/Apps/trackAppUsageCount.ts","routes/safe/components/Apps/components/SecurityFeedbackModal/UnknownAppWarning.tsx","routes/safe/components/Apps/components/PermissionCheckbox.tsx","routes/safe/components/Apps/communicator.ts","utils/url.ts","routes/safe/components/Apps/components/ConfirmTxModal/SafeAppLoadError.tsx","utils/decodeTx.ts","routes/safe/components/Apps/components/ConfirmTxModal/ReviewConfirm.tsx","routes/safe/components/Apps/components/ConfirmTxModal/index.tsx","routes/safe/components/Apps/hooks/useThirdPartyCookies.ts","routes/safe/components/Apps/hooks/useSignMessageModal.ts","components/ModalTitle/index.tsx","routes/safe/components/Apps/components/SignMessageModal/ReviewMessage.tsx","routes/safe/components/Apps/components/SignMessageModal/index.tsx","routes/safe/components/Apps/components/ThirdPartyCookiesWarning.tsx","routes/safe/components/Apps/components/PermissionsPrompt.tsx","routes/safe/components/Apps/hooks/useSafeAppFromManifest.ts","routes/safe/components/Apps/components/AppFrame.tsx","routes/safe/components/Apps/hooks/useIframeMessageHandler.ts","routes/safe/components/Apps/assets/addApp.svg","routes/safe/components/Apps/components/SearchInputCard.tsx","routes/safe/components/Apps/components/NoAppsFound.tsx","routes/safe/components/Apps/components/AddAppForm/AppAgreement.tsx","routes/safe/components/Apps/components/AddAppForm/AppUrl.tsx","routes/safe/components/Apps/components/AddAppForm/FormButtons.tsx","routes/safe/components/Apps/components/AddAppForm/index.tsx","routes/safe/components/Apps/components/PinnedAppsTutorial.tsx","routes/safe/components/Apps/components/AppsList.tsx","routes/safe/components/Apps/hooks/useAppsSearch.ts","routes/safe/components/Apps/components/SecurityFeedbackModal/Slider.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/LegalDisclaimer.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/SecurityFeedbackList.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/constants.ts","routes/safe/components/Apps/components/SecurityFeedbackModal/SecurityFeedbackContent.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/SecurityFeedbackAllowedFeatures.tsx","routes/safe/components/Apps/components/SecurityFeedbackModal/index.tsx","routes/safe/components/Apps/components/SafeAppsErrorBoundary.tsx","routes/safe/components/Apps/components/SafeAppsLoadError.tsx","routes/safe/components/Apps/hooks/useSecurityFeedbackModal.ts","routes/safe/components/Apps/index.tsx"],"names":["Wrapper","styled","div","StyledDivider","DividerSRC","StyledIcon","Icon","Divider","withArrow","type","size","StyledTitle","Title","centered","bold","StyledSecurityTitle","Text","gradientSK","keyframes","SafeAppLogoSK","props","SafeAppTitleSK","SafeAppDescriptionSK","setSafeAppLogoFallback","SafeAppCard","safeApp","togglePin","isPinned","isCustomSafeApp","onRemove","chainId","useSelector","currentChainId","dispatch","useDispatch","safeAddress","useSafeAddress","appsPath","generateSafeRoute","SAFE_ROUTES","APPS","shortName","getShortName","openSafeAppLink","encodeURI","url","fetchStatus","FETCH_STATUS","LOADING","SafeAppContainer","StyledAppCard","LogoContainer","DescriptionContainer","StyledLink","to","name","SafeAppLogo","src","iconUrl","alt","onError","SafeAppTitle","SafeAppDescription","color","description","ActionsContainer","onClick","e","preventDefault","IconBtn","text","range","document","createRange","listener","clipboardData","setData","selectNodeContents","body","getSelection","addRange","addEventListener","execCommand","removeEventListener","removeAllRanges","copyToClipboard","getShareSafeAppUrl","showNotification","NOTIFICATIONS","SHARE_SAFE_APP_URL_COPIED","tooltip","PinnedIcon","error","currentTarget","onerror","fallbackSafeAppLogoSvg","SAFE_APP_CARD_HEIGHT","SAFE_APP_CARD_PADDING","motion","attrs","layout","initial","opacity","animate","exit","Link","Card","primary200","primary300","img","IconButton","StyledSecurityFeedbackContentText","showInOneLine","SecurityFeedbackDomain","APPS_DASHBOARD","getAppsUsageData","local","getItem","trackSafeAppOpenCount","id","trackData","currentOpenCount","openCount","currentTxCount","txCount","setItem","timestamp","Date","now","trackSafeAppTxCount","rankSafeApps","apps","pinnedSafeApps","appsWithScore","computeTrackedSafeAppsScore","app","Object","entries","sort","a","b","map","val","minVal","maxVal","newMin","scoredApps","sortedByTimestamp","idx","timeMultiplier","length","StyledBox","Box","StyledWarningTitle","isColumnLayout","StyledWarningText","StyledText","StyledFormControlLabel","FormControlLabel","theme","colors","inputDisabled","UnknownAppWarning","onHideWarning","useState","toggleHideWarning","setToggleHideWarning","display","flexDirection","height","alignItems","mt","control","checked","onChange","label","PermissionsCheckbox","LegacyMethods","isValidURL","protocolsAllowed","urlInfo","URL","includes","protocol","Container","margin","sm","lg","IconText","FooterWrapper","SafeAppLoadError","onTxReject","onClose","requestId","cancelText","handleCancel","handleOk","okDisabled","okText","fetchTxDecoder","encodedData","getDecodedData","_getChainId","md","DecodeTxsWrapper","StyledBlock","Block","separator","ReviewConfirm","txs","params","ethBalance","safeName","onUserConfirm","onReject","appId","isMultiSend","decodedData","setDecodedData","nativeCurrency","getNativeCurrency","explorerUrl","getExplorerInfo","isOwner","grantedSelector","txRecipient","useMemo","getMultiSendCallOnlyContractAddress","txData","encodeMultiSendCall","data","txValue","value","toBN","toString","operation","Operation","DELEGATE","CALL","useEffect","isCurrent","decodeTxData","res","handleUserConfirmation","safeTxHash","TxModalWrapper","txTo","onSubmit","txParameters","delayExecution","createTransaction","valueInWei","origin","navigateToTransactionsTab","txNonce","safeNonce","safeTxGas","ethParameters","notifiedTransaction","TX_NOTIFICATION_TYPES","STANDARD_TX","isSubmitDisabled","onBack","ModalHeader","title","Hairline","Row","Paragraph","noMargin","PrefixedEthHashInfo","hash","strongName","showAvatar","showCopyBtn","strong","symbol","fromTokenUnit","decimals","DecodeTxs","ConfirmTxModal","some","t","test","undefined","mustBeEthereumAddress","isTxValid","Modal","open","isOpen","THIRD_PARTY_COOKIES_CHECK_URL","useThirdPartyCookies","iframeRef","useRef","thirdPartyCookiesDisabled","setThirdPartyCookiesDisabled","messageHandler","useCallback","event","hasOwnProperty","isCookieEnabled","window","removeChild","current","console","navigator","userAgent","indexOf","iframeElement","uri","onload","createElement","setAttribute","createIframe","contentWindow","postMessage","appendChild","setTimeout","clearTimeout","AppCommunicator","handlers","Map","on","method","handler","set","isValidMessage","msg","sentFromIframe","source","knownMethod","values","Methods","canHandleMessage","Boolean","get","send","sdkVersion","getSDKVersion","MessageFormatter","makeErrorResponse","makeResponse","handleIncomingMessage","validMessage","hasHandler","trackSafeAppMessage","env","response","message","logError","Errors","_901","contexts","request","clear","this","INITIAL_MODAL_STATE","signMessage","StyledParagraph","IconImg","TitleWrapper","StyledRow","StyledClose","Close","GoBackWrapper","ModalTitle","goBack","align","grow","weight","disableRipple","MessageTextArea","MuiTextField","InfoMessage","xs","ReviewMessage","utf8Message","handleTxRejection","signMethod","recipientName","rows","multiline","disabled","fullWidth","inputProps","placeholder","InputProps","disableUnderline","SignMessageModal","readableData","rest","web3","getWeb3ReadOnly","networkId","getSignMessageLibAddress","ZERO_ADDRESS","getSignMessageLibContractInstance","methods","eth","accounts","hashMessage","encodeABI","isHex","isHexStrict","humanReadableMessage","hexToUtf8","convertToHumanReadableMessage","signTypedMessage","isObjectEIP712TypedData","Error","JSON","stringify","typesCopy","types","EIP712Domain","_TypedDataEncoder","domain","ThirdPartyCookiesWarning","severity","href","target","PermissionsPrompt","permissions","onAccept","handleClose","style","top","Header","Body","permission","index","SAFE_PERMISSIONS_TEXTS","keys","Footer","Buttons","cancelButtonProps","variant","confirmButtonProps","useSafeAppFromManifest","appUrl","getEmptySafeApp","setSafeApp","isLoading","setIsLoading","loadApp","getAppInfoFromUrl","_900","AppWrapper","StyledCard","StyledIframe","iframe","INITIAL_CONFIRM_TX_MODAL_STATE","AppFrame","allowedFeaturesList","currentSafe","address","owners","threshold","getChainInfo","chainName","blockExplorerUriTemplate","state","addressBookEntryName","granted","addressBook","currentNetworkAddressBook","confirmTransactionModal","setConfirmTransactionModal","appIsLoading","setAppIsLoading","signMessageModalState","setSignMessageModalState","useSignMessageModal","openSignMessageModal","closeSignMessageModal","timer","isLoadingSlow","setIsLoadingSlow","errorTimer","setAppLoadError","currentApp","useRemoteSafeApps","remoteSafeApps","filter","useSafePermissions","confirmPermissionRequest","permissionsRequest","setPermissionsRequest","getPermissions","hasPermission","safeAppsRpc","getSafeAppsRpcServiceUrl","safeAppWeb3Provider","Web3","providers","HttpProvider","web3HttpProviderOptions","clearTimeouts","SAFE_POLLING_INTERVAL","openConfirmationModal","closeConfirmationModal","selectedApp","closeModal","currentSafeWithNames","sendMessageToIframe","requestWithMessage","Math","trunc","performance","version","handleIframeMessage","messageId","messagePayload","trackEvent","SAFE_APPS_EVENTS","LEGACY_API_CALL","getSafeAppName","SDK_MESSAGES","SEND_TRANSACTIONS","SAFE_APP_SDK_INITIALIZED","safeInfoMessage","INTERFACE_MESSAGES","ON_SAFE_INFO","network","getLegacyChainName","toLowerCase","envInfoMessage","ENV_INFO","txServiceUrl","getTxServiceUrl","onIframeMessage","useIframeMessageHandler","onIframeLoad","url1","url2","isSameURL","communicator","setCommunicator","communicatorInstance","initCommunicator","useAppCommunicator","getEnvInfo","getTxBySafeTxHash","fetchSafeTransaction","tx","getEnvironmentInfo","location","getSafeInfo","toUpperCase","parseInt","isReadOnly","getSafeBalances","currency","fetchTokenCurrenciesBalances","selectedCurrency","balances","wallet_getPermissions","wallet_requestPermissions","requestAddressBook","rpcCall","Promise","resolve","reject","jsonrpc","call","err","result","sendTransactions","transactions","checksumAddress","typedData","onUserTxConfirm","TRANSACTION_CONFIRMED","TRANSACTION_REJECTED","EMPTY_SAFE_APP","OPEN_APP","frameBorder","ref","onLoad","allow","PermissionStatus","GRANTED","DENIED","SearchInputCard","onValueChange","Input","startAdornment","endAdornment","width","onBlur","SEARCH","NoAppsFoundTextContainer","xxl","SButton","Button","NoAppsFound","query","onWalletConnectSearch","StyledCheckbox","Checkbox","AppAgreement","visited","useFormState","subscription","validate","agreementAccepted","required","Field","component","validateUrl","appUrlResolver","createDecorator","field","updates","isValidEnsName","getIpfsLinkFromEns","ensContent","AppInfoUpdater","onAppInfo","onLoading","useField","input","debouncedValue","useDebounce","updateAppInfo","appInfo","StyledAppUrlField","AppUrl","appList","composeValidators","uniqueApp","TextField","autoComplete","FormButtons","onCancel","valid","validating","fieldsVisited","isAppManifestValid","StyledTextFileAppName","AppInfo","AppDocsInfo","WrapperLoader","StyledLoader","Loader","INITIAL_VALUES","DEFAULT_APP_INFO","AddApp","onAddApp","setAppInfo","fetchError","setFetchError","history","useHistory","handleSubmit","ADD_CUSTOM_APP","push","pathname","extractPrefixedSafeAddress","search","encodeURIComponent","_903","GnoForm","decorators","initialValues","testId","as","rel","Img","meta","StyledBookmarkIcon","BookmarkBorder","PinnedAppsTutorial","InfoIcon","centerCSS","css","LoadingContainer","CardsWrapper","ContentWrapper","SectionHeading","xl","CenterIconText","AddCustomSafeAppCard","AddCustomAppLogo","AppsList","onRemoveApp","appSearch","setAppSearch","useAppList","allApps","removeApp","customApps","addCustomApp","searchText","fuse","Fuse","findAllMatches","item","useAppsSearch","appToRemove","setAppToRemove","useStateHandler","isAddAppModalOpen","openAddAppModal","toggle","closeAddAppModal","clickAway","noAppsFound","showCustomApps","showPinnedApps","Col","start","iconType","replace","Collapse","defaultExpanded","AnimatePresence","pinnedSafeApp","customSafeApp","AddAppIcon","iconSize","textSize","AddAppForm","StyledContainer","StyledInner","activeStep","SliderItem","Slider","onSlideChange","children","initialStep","allSlides","React","Children","toArray","setActiveStep","disabledBtn","setDisabledBtn","isFirstStep","className","slide","justifyContent","prevStep","nextStep","marginLeft","LegalDisclaimer","StyledDot","Dot","background","secondaryHover","StyledDotText","SecurityFeedbackList","practices","practice","marginBottom","subtitle","SECURITY_PRACTICES","imageSrc","StyledContentContainer","StyledImageContainer","StyledTextContainer","StyledImage","SecurityFeedbackContent","SecurityFeedbackAllowedFeatures","features","onFeatureSelectionChange","mx","my","ml","feature","_","BROWSER_PERMISSIONS_TEXTS","displayName","SecurityFeedbackModal","onConfirm","isConsentAccepted","isSafeAppInDefaultList","isFirstTimeAccessingApp","isExtendedListReviewed","isPermissionsReviewCompleted","hideWarning","setHideWarning","selectedFeatures","setSelectedFeatures","currentSlide","setCurrentSlide","totalSlides","progressValue","isLastSlide","shouldShowUnknownAppWarning","StyledWrapper","StyledLinearProgress","$isWarningStep","StyledGrid","container","direction","newStep","isLastStep","status","feat","white","alpha","shadow","Grid","LinearProgress","primary","memo","SafeAppsErrorBoundary","hasError","errorInfo","render","Component","Content","LinkWrapper","SafeAppsLoadError","currentSession","currentShortName","currentSafeAddress","APPS_SECURITY_FEEDBACK_MODAL","Apps","getAppUrl","useSafeAppUrl","useBrowserPermissions","addPermissions","getAllowedFeaturesList","isSafeAppListLoading","getSafeApp","isSafeAppManifestLoading","safeAppManifest","didMount","appsReviewed","setAppsReviewed","extendedListReviewed","setExtendedListReviewed","customAppsReviewed","setCustomAppsReviewed","consentAccepted","setConsentAccepted","isDisclaimerReadingCompleted","setIsDisclaimerReadingCompleted","securityStepsStatus","loadFromStorage","saveToStorage","safeAppId","safeAppsPermissions","every","PROMPT","isModalVisible","onComplete","shouldHide","browserPermissions","reviewedApps","onRemoveCustomApp","useSecurityFeedbackModal"],"mappings":"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","file":"static/js/43.2692c4f7.chunk.js","sourcesContent":["import { ReactElement } from 'react'\nimport styled from 'styled-components'\nimport { Icon, Divider as DividerSRC } from '@gnosis.pm/safe-react-components'\n\nconst Wrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  margin: 8px 0;\n\n  svg {\n    margin: 0 12px 0 4px;\n  }\n`\nconst StyledDivider = styled(DividerSRC)`\n  width: 100%;\n`\n\nconst StyledIcon = styled(Icon)`\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  padding: 0 20px;\n  background: white;\n\n  & svg {\n    margin: 0;\n  }\n`\n\ntype Props = {\n  withArrow?: boolean\n}\n\nconst Divider = ({ withArrow }: Props): ReactElement => (\n  <Wrapper>\n    {withArrow && <StyledIcon type=\"arrowDown\" size=\"md\" />}\n    <StyledDivider />\n  </Wrapper>\n)\n\nexport default Divider\n","import styled from 'styled-components'\nimport { Title, Text } from '@gnosis.pm/safe-react-components'\n\nexport const StyledTitle = styled(Title)<{ color?: string; bold?: boolean; centered?: boolean }>`\n  text-align: ${({ centered }) => (centered ? 'center' : 'left')};\n  margin: 24px 0;\n  color: inherit;\n  font-weight: ${({ bold }) => (bold ? 'bold' : 'normal')};\n`\n\nexport const StyledSecurityTitle = styled(Text)`\n  text-align: center;\n  color: #b2bbc0;\n  margin: 0 75px;\n`\n","import styled, { keyframes } from 'styled-components'\n\nexport const gradientSK = keyframes`\n0% {\n  background-position: 0% 54%;\n}\n50% {\n  background-position: 100% 47%;\n}\n100% {\n  background-position: 0% 54%;\n}\n`\n\nexport const SafeAppLogoSK = styled.div`\n  height: ${(props: { size }) => (props.size === 'lg' ? '112px' : '50px')};\n  width: ${(props: { size }) => (props.size === 'lg' ? '112px' : '50px')};\n  border-radius: 50%;\n  background-color: lightgrey;\n  background: linear-gradient(84deg, lightgrey, transparent);\n  background-size: 400% 400%;\n  animation: ${gradientSK} 1.5s ease infinite;\n`\n\nexport const SafeAppTitleSK = styled.div`\n  height: 18px;\n  width: 160px;\n  margin: 8px 0;\n\n  background-color: lightgrey;\n  background: linear-gradient(84deg, lightgrey, transparent);\n  background-size: 400% 400%;\n  animation: ${gradientSK} 1.5s ease infinite;\n`\n\nexport const SafeAppDescriptionSK = styled.div`\n  height: 12px;\n  width: 240px;\n  margin: 2px 0;\n\n  background-color: lightgrey;\n  background: linear-gradient(84deg, lightgrey, transparent);\n  background-size: 400% 400%;\n  animation: ${gradientSK} 1.5s ease infinite;\n`\n","import { SyntheticEvent } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\nimport { motion } from 'framer-motion'\nimport IconButton from '@material-ui/core/IconButton'\nimport { Card, Title, Text, Icon } from '@gnosis.pm/safe-react-components'\n\nimport { generateSafeRoute, getShareSafeAppUrl, SAFE_ROUTES } from 'src/routes/routes'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport fallbackSafeAppLogoSvg from 'src/assets/icons/apps.svg'\nimport { currentChainId } from 'src/logic/config/store/selectors'\nimport { showNotification } from 'src/logic/notifications/store/notifications'\nimport { NOTIFICATIONS } from 'src/logic/notifications'\nimport { FETCH_STATUS } from 'src/utils/requests'\nimport { copyToClipboard } from 'src/utils/clipboard'\nimport { getShortName } from 'src/config'\nimport { SafeAppDescriptionSK, SafeAppLogoSK, SafeAppTitleSK } from './SafeAppSkeleton'\nimport { primary200, primary300 } from 'src/theme/variables'\nimport useSafeAddress from 'src/logic/currentSession/hooks/useSafeAddress'\n\ntype SafeAppCardSize = 'md' | 'lg'\n\ntype SafeAppCardProps = {\n  safeApp: SafeApp\n  size: SafeAppCardSize\n  togglePin: (app: SafeApp) => void\n  isPinned?: boolean\n  isCustomSafeApp?: boolean\n  onRemove?: (app: SafeApp) => void\n}\n\nconst SafeAppCard = ({\n  safeApp,\n  size,\n  togglePin,\n  isPinned,\n  isCustomSafeApp,\n  onRemove,\n}: SafeAppCardProps): React.ReactElement => {\n  const chainId = useSelector(currentChainId)\n  const dispatch = useDispatch()\n\n  const { safeAddress } = useSafeAddress()\n  const appsPath = generateSafeRoute(SAFE_ROUTES.APPS, {\n    shortName: getShortName(),\n    safeAddress,\n  })\n  const openSafeAppLink = `${appsPath}?appUrl=${encodeURI(safeApp.url)}`\n\n  const shareSafeApp = () => {\n    const shareSafeAppUrl = getShareSafeAppUrl(safeApp.url, chainId)\n    copyToClipboard(shareSafeAppUrl)\n    dispatch(showNotification(NOTIFICATIONS.SHARE_SAFE_APP_URL_COPIED))\n  }\n\n  const isSafeAppLoading = safeApp.fetchStatus === FETCH_STATUS.LOADING\n\n  if (isSafeAppLoading) {\n    return (\n      <SafeAppContainer size={size}>\n        <StyledAppCard size={size}>\n          <LogoContainer size={size}>\n            <SafeAppLogoSK size={size} />\n          </LogoContainer>\n          <DescriptionContainer size={size}>\n            <SafeAppTitleSK />\n            <SafeAppDescriptionSK />\n            <SafeAppDescriptionSK />\n          </DescriptionContainer>\n        </StyledAppCard>\n      </SafeAppContainer>\n    )\n  }\n\n  return (\n    <SafeAppContainer size={size}>\n      <StyledLink to={openSafeAppLink} aria-label={`open ${safeApp.name} Safe App`}>\n        <StyledAppCard size={size}>\n          {/* Safe App Logo */}\n          <LogoContainer size={size}>\n            <SafeAppLogo\n              size={size}\n              src={safeApp.iconUrl}\n              alt={`${safeApp.name || 'Safe App'} Logo`}\n              onError={setSafeAppLogoFallback}\n            />\n          </LogoContainer>\n\n          {/* Safe App Description */}\n          <DescriptionContainer size={size}>\n            <SafeAppTitle size=\"xs\">{safeApp.name}</SafeAppTitle>\n            <SafeAppDescription size=\"lg\" color=\"inputFilled\">\n              {safeApp.description}\n            </SafeAppDescription>\n          </DescriptionContainer>\n\n          {/* Safe App Actions */}\n          <ActionsContainer onClick={(e) => e.preventDefault()}>\n            {/* Share Safe App button */}\n            <IconBtn onClick={shareSafeApp} aria-label={`copy ${safeApp.name} Safe App share link to clipboard`}>\n              <Icon size=\"md\" type=\"share\" tooltip=\"Copy share link\" />\n            </IconBtn>\n\n            {/* Pin & Unpin Safe App button */}\n            {!isCustomSafeApp && (\n              <IconBtn\n                onClick={() => togglePin(safeApp)}\n                aria-label={`${isPinned ? 'Unpin' : 'Pin'} ${safeApp.name} Safe App`}\n              >\n                {isPinned ? (\n                  <PinnedIcon size=\"md\" type=\"bookmarkFilled\" color=\"primary\" tooltip=\"Unpin from the Safe Apps\" />\n                ) : (\n                  <PinnedIcon size=\"md\" type=\"bookmark\" tooltip=\"Pin from the Safe Apps\" />\n                )}\n              </IconBtn>\n            )}\n\n            {/* Remove custom Safe App button */}\n            {isCustomSafeApp && (\n              <IconBtn onClick={() => onRemove?.(safeApp)} aria-label={`Remove ${safeApp.name} custom Safe App`}>\n                <Icon size=\"md\" type=\"delete\" color=\"error\" tooltip=\"Remove Custom Safe App\" />\n              </IconBtn>\n            )}\n          </ActionsContainer>\n        </StyledAppCard>\n      </StyledLink>\n    </SafeAppContainer>\n  )\n}\n\nexport default SafeAppCard\n\nconst setSafeAppLogoFallback = (error: SyntheticEvent<HTMLImageElement, Event>): void => {\n  error.currentTarget.onerror = null\n  error.currentTarget.src = fallbackSafeAppLogoSvg\n}\n\nexport const SAFE_APP_CARD_HEIGHT = 190\nexport const SAFE_APP_CARD_PADDING = 16\n\nconst SafeAppContainer = styled(motion.div).attrs({\n  layout: true,\n  initial: { opacity: 0 },\n  animate: { opacity: 1 },\n  exit: { opacity: 0 },\n})`\n  position: relative;\n  display: flex;\n  height: ${SAFE_APP_CARD_HEIGHT}px;\n\n  grid-column: span ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? '2' : '1')};\n`\n\nconst StyledLink = styled(Link)`\n  display: flex;\n  flex: 1 0;\n  height: ${SAFE_APP_CARD_HEIGHT}px;\n  text-decoration: none;\n`\n\nconst StyledAppCard = styled(Card)`\n  flex: 1 1 100%;\n  padding: ${SAFE_APP_CARD_PADDING}px;\n  display: flex;\n  flex-direction: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? 'row' : 'column')};\n  box-shadow: none;\n  border: 2px solid transparent;\n\n  transition: all 0.3s ease-in-out 0s;\n  transition-property: border-color, background-color;\n\n  :hover {\n    background-color: ${primary200};\n    border: 2px solid ${primary300};\n  }\n`\n\nconst LogoContainer = styled.div`\n  flex: 0 0;\n  flex-basis: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? '50%' : 'auto')};\n\n  display: flex;\n  justify-content: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? 'center' : 'start')};\n  align-items: center;\n`\n\nconst SafeAppLogo = styled.img`\n  height: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? '112px' : '50px')};\n  width: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? '112px' : '50px')};\n  object-fit: contain;\n`\n\nconst DescriptionContainer = styled.div`\n  flex: 0 0;\n\n  flex-basis: ${(props: { size: SafeAppCardSize }) => (props.size === 'lg' ? '50%' : 'auto')};\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`\n\nconst SafeAppTitle = styled(Title)`\n  margin: 8px 0px;\n  font-size: 16px;\n  line-height: 22px;\n  font-weight: bold;\n  color: initial;\n`\n\nconst SafeAppDescription = styled(Text)`\n  margin: 0;\n  line-height: 22px;\n\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n`\n\nconst ActionsContainer = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  margin: 16px 12px;\n`\n\nconst IconBtn = styled(IconButton)`\n  padding: 8px;\n\n  && svg {\n    width: 16px;\n    height: 16px;\n  }\n`\nconst PinnedIcon = styled(Icon)`\n  padding-left: 2px;\n`\n","export const copyToClipboard = (text: string): void => {\n  const range = document.createRange()\n  range.selectNodeContents(document.body)\n  document?.getSelection()?.addRange(range)\n\n  function listener(e: ClipboardEvent) {\n    e.clipboardData?.setData('text/plain', text)\n    e.preventDefault()\n  }\n  document.addEventListener('copy', listener)\n  document.execCommand('copy')\n  document.removeEventListener('copy', listener)\n\n  document?.getSelection()?.removeAllRanges()\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Icon, Text } from '@gnosis.pm/safe-react-components'\n\ntype SecurityFeedbackDomainProps = {\n  url: string\n  showInOneLine?: boolean\n}\n\nconst SecurityFeedbackDomain: React.FC<SecurityFeedbackDomainProps> = ({ url, showInOneLine }): React.ReactElement => {\n  return (\n    <StyledSecurityFeedbackContentText size=\"xl\" showInOneLine={!!showInOneLine}>\n      <StyledIcon type=\"check\" color=\"primary\" size=\"sm\" /> {url}\n    </StyledSecurityFeedbackContentText>\n  )\n}\n\nconst StyledIcon = styled(Icon)`\n  position: relative;\n  top: 4px;\n  padding-right: 4px;\n`\n\nconst StyledSecurityFeedbackContentText = styled(Text)<{ showInOneLine: boolean }>`\n  display: block;\n  font-size: 12px;\n  font-weight: bold;\n  overflow-wrap: anywhere;\n  background-color: #effaf8;\n  padding: 10px 15px 10px 10px;\n  border-radius: 8px;\n  max-width: 75%;\n  ${({ showInOneLine }) =>\n    showInOneLine &&\n    `overflow-y: hidden;\n     white-space: nowrap;\n     `}\n`\n\nexport default SecurityFeedbackDomain\n","import { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport local from 'src/utils/storage/local'\n\nexport const APPS_DASHBOARD = 'APPS_DASHBOARD'\n\nconst TX_COUNT_WEIGHT = 2\nconst OPEN_COUNT_WEIGHT = 1\nconst PINNED_WEIGHT = 10\n\nexport type AppTrackData = {\n  [safeAppId: string]: {\n    timestamp: number\n    openCount: number\n    txCount: number\n  }\n}\n\nexport const getAppsUsageData = (): AppTrackData => {\n  return local.getItem<AppTrackData>(APPS_DASHBOARD) || {}\n}\n\nexport const trackSafeAppOpenCount = (id: SafeApp['id']): void => {\n  const trackData = getAppsUsageData()\n  const currentOpenCount = trackData[id]?.openCount || 0\n  const currentTxCount = trackData[id]?.txCount || 0\n\n  local.setItem(APPS_DASHBOARD, {\n    ...trackData,\n    [id]: {\n      timestamp: Date.now(),\n      openCount: currentOpenCount + 1,\n      txCount: currentTxCount,\n    },\n  })\n}\n\nexport const trackSafeAppTxCount = (id: SafeApp['id']): void => {\n  const trackData = getAppsUsageData()\n  const currentTxCount = trackData[id]?.txCount || 0\n\n  local.setItem(APPS_DASHBOARD, {\n    ...trackData,\n    // The object contains the openCount when we are creating a transaction\n    [id]: { ...trackData[id], txCount: currentTxCount + 1 },\n  })\n}\n\n// https://stackoverflow.com/a/55212064\nconst normalizeBetweenTwoRanges = (\n  val: number,\n  minVal: number,\n  maxVal: number,\n  newMin: number,\n  newMax: number,\n): number => {\n  return newMin + ((val - minVal) * (newMax - newMin)) / (maxVal - minVal)\n}\n\nexport const rankSafeApps = (apps: AppTrackData, pinnedSafeApps: SafeApp[]): string[] => {\n  const appsWithScore = computeTrackedSafeAppsScore(apps)\n\n  for (const app of pinnedSafeApps) {\n    if (appsWithScore[app.id]) {\n      appsWithScore[app.id] += PINNED_WEIGHT\n    } else {\n      appsWithScore[app.id] = PINNED_WEIGHT\n    }\n  }\n\n  return Object.entries(appsWithScore)\n    .sort((a, b) => b[1] - a[1])\n    .map((app) => app[0])\n}\n\nexport const computeTrackedSafeAppsScore = (apps: AppTrackData): Record<string, number> => {\n  const scoredApps: Record<string, number> = {}\n\n  const sortedByTimestamp = Object.entries(apps).sort((a, b) => {\n    return a[1].timestamp - b[1].timestamp\n  })\n\n  for (const [idx, app] of sortedByTimestamp.entries()) {\n    // UNIX Timestamps add too much weight, so we normalize by uniformly distributing them to range [1..2]\n    const timeMultiplier = normalizeBetweenTwoRanges(idx, 0, sortedByTimestamp.length, 1, 2)\n\n    scoredApps[app[0]] = (TX_COUNT_WEIGHT * app[1].txCount + OPEN_COUNT_WEIGHT * app[1].openCount) * timeMultiplier\n  }\n\n  return scoredApps\n}\n","import { useState } from 'react'\nimport Box from '@material-ui/core/Box'\nimport Checkbox from '@material-ui/core/Checkbox'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport styled from 'styled-components'\nimport { Text, Icon } from '@gnosis.pm/safe-react-components'\n\nimport { StyledTitle } from 'src/routes/safe/components/Apps/components/SecurityFeedbackModal/styles'\nimport SecurityFeedbackDomain from './SecurityFeedbackDomain'\n\ntype UnknownAppWarningProps = {\n  url?: string\n  onHideWarning?: (hideWarning: boolean) => void\n}\n\nconst UnknownAppWarning = ({ url, onHideWarning }: UnknownAppWarningProps): React.ReactElement => {\n  const [toggleHideWarning, setToggleHideWarning] = useState(false)\n\n  const handleToggleWarningPreference = (): void => {\n    onHideWarning?.(!toggleHideWarning)\n    setToggleHideWarning(!toggleHideWarning)\n  }\n\n  const isColumnLayout = !!onHideWarning\n\n  return (\n    <StyledBox\n      display={isColumnLayout ? 'flex' : 'block'}\n      flexDirection=\"column\"\n      height={isColumnLayout ? '100%' : 'auto'}\n      alignItems=\"center\"\n    >\n      <Box display={isColumnLayout ? 'block' : 'flex'} alignItems=\"center\" mt={isColumnLayout ? 6 : 0}>\n        <StyledIcon type=\"alert\" size=\"md\" isColumnLayout={isColumnLayout} />\n        <StyledWarningTitle size=\"sm\" bold isColumnLayout={isColumnLayout}>\n          Warning\n        </StyledWarningTitle>\n      </Box>\n      <StyledWarningText isColumnLayout={isColumnLayout} size=\"xl\">\n        The application you are trying to access is not in the default Safe Apps list\n      </StyledWarningText>\n      <br />\n      <StyledText isColumnLayout={isColumnLayout} size=\"lg\">\n        Check the link you are using and ensure that it comes from a source you trust\n      </StyledText>\n      <br />\n      {url && <SecurityFeedbackDomain url={url} showInOneLine />}\n      <br />\n      {onHideWarning && (\n        <StyledFormControlLabel\n          control={\n            <Checkbox\n              checked={toggleHideWarning}\n              onChange={handleToggleWarningPreference}\n              name=\"Warning message preference\"\n            />\n          }\n          label=\"Don't show this warning again\"\n        />\n      )}\n    </StyledBox>\n  )\n}\n\nconst StyledBox = styled(Box)`\n  color: #e8663d;\n`\n\nconst StyledWarningTitle = styled(StyledTitle)<{ isColumnLayout: boolean }>`\n  font-size: 24px;\n  margin-left: 4px;\n  margin-top: ${({ isColumnLayout }) => (isColumnLayout ? '12px' : '24px')};\n`\n\nconst StyledWarningText = styled(Text)<{ isColumnLayout: boolean }>`\n  color: inherit;\n  text-align: ${({ isColumnLayout }) => (isColumnLayout ? 'center' : 'left')};\n`\n\nconst StyledText = styled(Text)<{ isColumnLayout: boolean }>`\n  text-align: ${({ isColumnLayout }) => (isColumnLayout ? 'center' : 'left')};\n`\n\nconst StyledIcon = styled(Icon)<{ isColumnLayout: boolean }>`\n  svg {\n    width: ${({ isColumnLayout }) => (isColumnLayout ? '32px' : '24px')};\n    height: ${({ isColumnLayout }) => (isColumnLayout ? '32px' : '24px')};\n  }\n  .icon-color {\n    fill: #e8663d;\n  }\n\n  .icon-stroke {\n    stroke: #e8663d;\n  }\n`\n\nconst StyledFormControlLabel = styled(FormControlLabel)`\n  flex: 1;\n  color: #000;\n  .MuiIconButton-root:not(.Mui-checked) {\n    color: ${({ theme }) => theme.colors.inputDisabled};\n  }\n`\n\nexport default UnknownAppWarning\n","import styled from 'styled-components'\nimport { Checkbox, FormControlLabel } from '@material-ui/core'\n\ntype PermissionsCheckboxProps = {\n  label: string\n  name: string\n  checked: boolean\n  onChange: (event: React.ChangeEvent<HTMLInputElement>, checked: boolean) => void\n}\n\nconst PermissionsCheckbox = ({ label, checked, onChange, name }: PermissionsCheckboxProps): React.ReactElement => (\n  <StyledFormControlLabel control={<Checkbox checked={checked} onChange={onChange} name={name} />} label={label} />\n)\n\nconst StyledFormControlLabel = styled(FormControlLabel)`\n  flex: 1;\n  .MuiIconButton-root:not(.Mui-checked) {\n    color: ${({ theme }) => theme.colors.inputDisabled};\n  }\n`\nexport default PermissionsCheckbox\n","import { MutableRefObject, useEffect, useState } from 'react'\nimport {\n  getSDKVersion,\n  SDKMessageEvent,\n  MethodToResponse,\n  Methods,\n  ErrorResponse,\n  MessageFormatter,\n  RequestId,\n} from '@gnosis.pm/safe-apps-sdk'\nimport { Errors, logError } from 'src/logic/exceptions/CodedException'\nimport { SafeApp } from './types'\nimport { trackSafeAppMessage } from 'src/utils/googleTagManager'\n\ntype MessageHandler = (\n  msg: SDKMessageEvent,\n) => void | MethodToResponse[Methods] | ErrorResponse | Promise<MethodToResponse[Methods] | ErrorResponse | void>\n\nexport enum LegacyMethods {\n  getEnvInfo = 'getEnvInfo',\n}\n\ntype SDKMethods = Methods | LegacyMethods\n\nclass AppCommunicator {\n  private iframeRef: MutableRefObject<HTMLIFrameElement | null>\n  private handlers = new Map<SDKMethods, MessageHandler>()\n  private app: SafeApp\n\n  constructor(iframeRef: MutableRefObject<HTMLIFrameElement | null>, app: SafeApp) {\n    this.iframeRef = iframeRef\n    this.app = app\n\n    window.addEventListener('message', this.handleIncomingMessage)\n  }\n\n  on = (method: SDKMethods, handler: MessageHandler): void => {\n    this.handlers.set(method, handler)\n  }\n\n  private isValidMessage = (msg: SDKMessageEvent): boolean => {\n    if (msg.data.hasOwnProperty('isCookieEnabled')) {\n      return true\n    }\n\n    const sentFromIframe = this.iframeRef.current?.contentWindow === msg.source\n    const knownMethod = Object.values(Methods).includes(msg.data.method)\n\n    return sentFromIframe && knownMethod\n  }\n\n  private canHandleMessage = (msg: SDKMessageEvent): boolean => {\n    return Boolean(this.handlers.get(msg.data.method))\n  }\n\n  send = (data: unknown, requestId: RequestId, error = false): void => {\n    const sdkVersion = getSDKVersion()\n    const msg = error\n      ? MessageFormatter.makeErrorResponse(requestId, data as string, sdkVersion)\n      : MessageFormatter.makeResponse(requestId, data, sdkVersion)\n\n    this.iframeRef.current?.contentWindow?.postMessage(msg, '*')\n  }\n\n  handleIncomingMessage = async (msg: SDKMessageEvent): Promise<void> => {\n    const validMessage = this.isValidMessage(msg)\n    const hasHandler = this.canHandleMessage(msg)\n\n    if (validMessage && hasHandler) {\n      trackSafeAppMessage({\n        app: this.app,\n        method: msg.data.method,\n        params: msg.data.params,\n        sdkVersion: msg.data.env.sdkVersion,\n      })\n\n      const handler = this.handlers.get(msg.data.method)\n      try {\n        // @ts-expect-error Handler existence is checked in this.canHandleMessage\n        const response = await handler(msg)\n\n        // If response is not returned, it means the response will be send somewhere else\n        if (typeof response !== 'undefined') {\n          this.send(response, msg.data.id)\n        }\n      } catch (err) {\n        this.send(err.message, msg.data.id, true)\n        logError(Errors._901, err.message, {\n          contexts: {\n            safeApp: this.app,\n            request: msg.data,\n          },\n        })\n      }\n    }\n  }\n\n  clear = (): void => {\n    window.removeEventListener('message', this.handleIncomingMessage)\n  }\n}\n\nconst useAppCommunicator = (\n  iframeRef: MutableRefObject<HTMLIFrameElement | null>,\n  app?: SafeApp,\n): AppCommunicator | undefined => {\n  const [communicator, setCommunicator] = useState<AppCommunicator | undefined>(undefined)\n  useEffect(() => {\n    let communicatorInstance\n    const initCommunicator = (iframeRef: MutableRefObject<HTMLIFrameElement>, app: SafeApp) => {\n      communicatorInstance = new AppCommunicator(iframeRef, app)\n      setCommunicator(communicatorInstance)\n    }\n\n    if (app) {\n      initCommunicator(iframeRef as MutableRefObject<HTMLIFrameElement>, app)\n    }\n\n    return () => {\n      communicatorInstance?.clear()\n    }\n  }, [app, iframeRef])\n\n  return communicator\n}\n\nexport { useAppCommunicator }\n","export const isValidURL = (url: string, protocolsAllowed = ['https:', 'http:']): boolean => {\n  try {\n    const urlInfo = new URL(url)\n    return protocolsAllowed.includes(urlInfo.protocol)\n  } catch (error) {\n    return false\n  }\n}\n\nexport const isSameURL = (url1: string, url2: string): boolean => {\n  try {\n    const a = new URL(url1)\n    const b = new URL(url2)\n    return a.href === b.href\n  } catch (error) {\n    return false\n  }\n}\n","import { ReactElement } from 'react'\nimport { Icon, Text, Title, ModalFooterConfirmation } from '@gnosis.pm/safe-react-components'\nimport styled from 'styled-components'\nimport { ConfirmTxModalProps } from '.'\n\nconst Container = styled.div`\n  padding: ${({ theme }) => `${theme.margin.sm} ${theme.margin.lg}`};\n`\n\nconst IconText = styled.div`\n  display: flex;\n  align-items: center;\n\n  span {\n    margin-right: 4px;\n  }\n`\n\nconst FooterWrapper = styled.div`\n  margin-top: 15px;\n`\n\nexport const SafeAppLoadError = ({ onTxReject, onClose, requestId }: ConfirmTxModalProps): ReactElement => {\n  const handleTxRejection = () => {\n    onTxReject(requestId)\n    onClose()\n  }\n\n  return (\n    <Container>\n      <IconText>\n        <Icon color=\"error\" size=\"md\" type=\"info\" />\n        <Title size=\"xs\">Transaction error</Title>\n      </IconText>\n      <Text size=\"lg\">\n        This Safe App initiated a transaction which cannot be processed. Please get in touch with the developer of this\n        Safe App for more information.\n      </Text>\n\n      <FooterWrapper>\n        <ModalFooterConfirmation\n          cancelText=\"Cancel\"\n          handleCancel={() => handleTxRejection()}\n          handleOk={() => {}}\n          okDisabled\n          okText=\"Submit\"\n        />\n      </FooterWrapper>\n    </Container>\n  )\n}\n","import { getDecodedData, DecodedDataResponse } from '@gnosis.pm/safe-react-gateway-sdk'\n\nimport { _getChainId } from 'src/config'\n\nexport const fetchTxDecoder = async (encodedData: string): Promise<DecodedDataResponse | null> => {\n  if (!encodedData?.length || encodedData === '0x') {\n    return null\n  }\n\n  try {\n    return await getDecodedData(_getChainId(), encodedData)\n  } catch (error) {\n    return null\n  }\n}\n","import { Operation } from '@gnosis.pm/safe-react-gateway-sdk'\nimport { Text } from '@gnosis.pm/safe-react-components'\nimport { ReactElement, useEffect, useMemo, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled from 'styled-components'\nimport { toBN } from 'web3-utils'\n\nimport { createTransaction } from 'src/logic/safe/store/actions/createTransaction'\nimport { getMultiSendCallOnlyContractAddress } from 'src/logic/contracts/safeContracts'\nimport { TX_NOTIFICATION_TYPES } from 'src/logic/safe/transactions'\nimport { encodeMultiSendCall } from 'src/logic/safe/transactions/multisend'\nimport { getExplorerInfo, getNativeCurrency } from 'src/config'\nimport { ModalHeader } from 'src/routes/safe/components/Balances/SendModal/screens/ModalHeader'\nimport { lg, md } from 'src/theme/variables'\nimport { TxParameters } from 'src/routes/safe/container/hooks/useTransactionParameters'\nimport { BasicTxInfo, DecodeTxs } from 'src/components/DecodeTxs'\nimport { fetchTxDecoder } from 'src/utils/decodeTx'\nimport { fromTokenUnit } from 'src/logic/tokens/utils/humanReadableValue'\nimport Block from 'src/components/layout/Block'\nimport Hairline from 'src/components/layout/Hairline'\nimport Divider from 'src/components/Divider'\nimport PrefixedEthHashInfo from 'src/components/PrefixedEthHashInfo'\n\nimport { ConfirmTxModalProps, DecodedTxDetailType } from '.'\nimport { grantedSelector } from 'src/routes/safe/container/selector'\nimport { TxModalWrapper } from 'src/routes/safe/components/Transactions/helpers/TxModalWrapper'\nimport Paragraph from 'src/components/layout/Paragraph'\nimport Row from 'src/components/layout/Row'\nimport { trackSafeAppTxCount } from 'src/routes/safe/components/Apps/trackAppUsageCount'\n\nconst Container = styled.div`\n  max-width: 480px;\n  padding: ${md} ${lg} 0;\n`\n\nconst DecodeTxsWrapper = styled.div`\n  margin: 0;\n`\n\nconst StyledBlock = styled(Block)`\n  background-color: ${({ theme }) => theme.colors.separator};\n  width: fit-content;\n  padding: 5px 10px;\n  border-radius: 3px;\n  margin: 4px 0 0 40px;\n\n  display: flex;\n\n  > :nth-child(1) {\n    margin-right: 5px;\n  }\n`\n\ntype Props = ConfirmTxModalProps & {\n  onReject: () => void\n}\n\nconst parseTxValue = (value: string | number): string => {\n  return toBN(value).toString()\n}\n\nexport const ReviewConfirm = ({\n  app,\n  txs,\n  params,\n  safeAddress,\n  ethBalance,\n  safeName,\n  onUserConfirm,\n  onClose,\n  onReject,\n  requestId,\n  appId,\n}: Props): ReactElement => {\n  const isMultiSend = txs.length > 1\n  const [decodedData, setDecodedData] = useState<DecodedTxDetailType>()\n  const dispatch = useDispatch()\n  const nativeCurrency = getNativeCurrency()\n  const explorerUrl = getExplorerInfo(safeAddress)\n  const isOwner = useSelector(grantedSelector)\n\n  const txRecipient: string | undefined = useMemo(\n    () => (isMultiSend ? getMultiSendCallOnlyContractAddress() : txs[0]?.to),\n    [txs, isMultiSend],\n  )\n  const txData: string | undefined = useMemo(\n    () => (isMultiSend ? encodeMultiSendCall(txs) : txs[0]?.data),\n    [txs, isMultiSend],\n  )\n  const txValue: string | undefined = useMemo(\n    () => (isMultiSend ? '0' : parseTxValue(txs[0]?.value)),\n    [txs, isMultiSend],\n  )\n  const operation = useMemo(() => (isMultiSend ? Operation.DELEGATE : Operation.CALL), [isMultiSend])\n\n  // Decode tx data.\n  useEffect(() => {\n    let isCurrent = true\n    const decodeTxData = async () => {\n      const res = await fetchTxDecoder(txData)\n      if (res && isCurrent) {\n        setDecodedData(res)\n      }\n    }\n\n    decodeTxData()\n    return () => {\n      isCurrent = false\n    }\n  }, [txData])\n\n  const handleUserConfirmation = (safeTxHash: string): void => {\n    onUserConfirm(safeTxHash, requestId)\n    onClose()\n  }\n\n  const confirmTransactions = (txParameters: TxParameters, delayExecution: boolean) => {\n    trackSafeAppTxCount(appId)\n    dispatch(\n      createTransaction(\n        {\n          safeAddress,\n          to: txRecipient,\n          valueInWei: txValue,\n          txData,\n          operation,\n          origin: app.id,\n          navigateToTransactionsTab: false,\n          txNonce: txParameters.safeNonce,\n          safeTxGas: txParameters.safeTxGas,\n          ethParameters: txParameters,\n          notifiedTransaction: TX_NOTIFICATION_TYPES.STANDARD_TX,\n          delayExecution,\n        },\n        handleUserConfirmation,\n        onReject,\n      ),\n    )\n  }\n\n  return (\n    <TxModalWrapper\n      txTo={txRecipient}\n      txData={txData}\n      txValue={txValue}\n      operation={operation}\n      onSubmit={confirmTransactions}\n      isSubmitDisabled={!isOwner}\n      onBack={onReject}\n      safeTxGas={params?.safeTxGas?.toString()}\n    >\n      <div>\n        <ModalHeader title={app.name} iconUrl={app.iconUrl} onClose={onReject} />\n\n        <Hairline />\n\n        <Container>\n          {/* Safe */}\n          <Row margin=\"xs\">\n            <Paragraph color=\"disabled\" noMargin size=\"lg\">\n              Sending from\n            </Paragraph>\n          </Row>\n          <PrefixedEthHashInfo\n            name={safeName}\n            hash={safeAddress}\n            strongName\n            showAvatar\n            showCopyBtn\n            explorerUrl={explorerUrl}\n          />\n          <StyledBlock>\n            <Text size=\"md\">Balance:</Text>\n            <Text size=\"md\" strong>{`${ethBalance} ${nativeCurrency.symbol}`}</Text>\n          </StyledBlock>\n\n          <Divider withArrow />\n\n          {/* Txs decoded */}\n          <BasicTxInfo\n            txRecipient={txRecipient}\n            txData={txData}\n            txValue={fromTokenUnit(txValue, nativeCurrency.decimals)}\n          />\n\n          {txs.length > 0 && (\n            <DecodeTxsWrapper>\n              <DecodeTxs txs={txs} decodedData={decodedData} />\n            </DecodeTxsWrapper>\n          )}\n        </Container>\n      </div>\n    </TxModalWrapper>\n  )\n}\n","import { ReactElement } from 'react'\nimport { Transaction } from '@gnosis.pm/safe-apps-sdk-v1'\nimport { RequestId } from '@gnosis.pm/safe-apps-sdk'\nimport { DecodedDataParameterValue, DecodedDataResponse } from '@gnosis.pm/safe-react-gateway-sdk'\n\nimport Modal from 'src/components/Modal'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport { TransactionParams } from 'src/routes/safe/components/Apps/components/AppFrame'\nimport { mustBeEthereumAddress } from 'src/components/forms/validator'\nimport { SafeAppLoadError } from './SafeAppLoadError'\nimport { ReviewConfirm } from './ReviewConfirm'\n\nexport type ConfirmTxModalProps = {\n  isOpen: boolean\n  app: SafeApp\n  txs: Transaction[]\n  params?: TransactionParams\n  safeAddress: string\n  safeName: string\n  requestId: RequestId\n  ethBalance: string\n  onUserConfirm: (safeTxHash: string, requestId: RequestId) => void\n  onTxReject: (requestId: RequestId) => void\n  onClose: () => void\n  appId: string\n}\n\nconst isTxValid = (t: Transaction): boolean => {\n  if (!['string', 'number'].includes(typeof t.value)) {\n    return false\n  }\n\n  if (typeof t.value === 'string' && !/^(0x)?[0-9a-f]+$/i.test(t.value)) {\n    return false\n  }\n\n  const isAddressValid = mustBeEthereumAddress(t.to) === undefined\n  return isAddressValid && !!t.data && typeof t.data === 'string'\n}\n\nexport type DecodedTxDetailType = DecodedDataParameterValue | DecodedDataResponse | undefined\n\nexport const ConfirmTxModal = (props: ConfirmTxModalProps): ReactElement => {\n  const invalidTransactions = !props.txs.length || props.txs.some((t) => !isTxValid(t))\n\n  const rejectTransaction = () => {\n    props.onClose()\n    props.onTxReject(props.requestId)\n  }\n\n  if (invalidTransactions) {\n    return (\n      <Modal description=\"Safe App transaction\" title=\"Safe App transaction\" open={props.isOpen}>\n        <SafeAppLoadError {...props} />\n      </Modal>\n    )\n  }\n\n  return (\n    <Modal description=\"Safe App transaction\" title=\"Safe App transaction\" open={props.isOpen}>\n      <ReviewConfirm {...props} onReject={rejectTransaction} />\n    </Modal>\n  )\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\n\nexport const THIRD_PARTY_COOKIES_CHECK_URL = 'https://third-party-cookies-check.gnosis-safe.com'\nconst SHOW_ALERT_TIMEOUT = 10000\n\nconst isSafari = (): boolean => {\n  return navigator.userAgent.indexOf('Safari') > -1 && navigator.userAgent.indexOf('Chrome') <= -1\n}\n\nconst createIframe = (uri: string, onload: () => void): HTMLIFrameElement => {\n  const iframeElement: HTMLIFrameElement = document.createElement('iframe')\n\n  iframeElement.src = uri\n  iframeElement.setAttribute('style', 'display:none')\n  iframeElement.onload = onload\n\n  return iframeElement\n}\n\ntype ThirdPartyCookiesType = {\n  thirdPartyCookiesDisabled: boolean\n  setThirdPartyCookiesDisabled: (value: boolean) => void\n}\n\nconst useThirdPartyCookies = (): ThirdPartyCookiesType => {\n  const iframeRef = useRef<HTMLIFrameElement>()\n  const [thirdPartyCookiesDisabled, setThirdPartyCookiesDisabled] = useState<boolean>(false)\n\n  const messageHandler = useCallback((event: MessageEvent) => {\n    const data = event.data\n\n    try {\n      if (data.hasOwnProperty('isCookieEnabled')) {\n        setThirdPartyCookiesDisabled(!data.isCookieEnabled)\n        window.removeEventListener('message', messageHandler)\n        document.body.removeChild(iframeRef.current as Node)\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, [])\n\n  useEffect(() => {\n    if (isSafari()) {\n      return\n    }\n\n    window.addEventListener('message', messageHandler)\n\n    const iframeElement: HTMLIFrameElement = createIframe(THIRD_PARTY_COOKIES_CHECK_URL, () =>\n      iframeElement?.contentWindow?.postMessage({ test: 'cookie' }, '*'),\n    )\n\n    iframeRef.current = iframeElement\n    document.body.appendChild(iframeElement)\n  }, [messageHandler])\n\n  useEffect(() => {\n    let id: ReturnType<typeof setTimeout>\n\n    if (thirdPartyCookiesDisabled) {\n      id = setTimeout(() => setThirdPartyCookiesDisabled(false), SHOW_ALERT_TIMEOUT)\n    }\n\n    return () => clearTimeout(id)\n  }, [thirdPartyCookiesDisabled])\n\n  return { thirdPartyCookiesDisabled, setThirdPartyCookiesDisabled }\n}\n\nexport { useThirdPartyCookies }\n","import { useState, useCallback } from 'react'\nimport { EIP712TypedData, Methods } from '@gnosis.pm/safe-apps-sdk'\n\ntype StateType = {\n  isOpen: boolean\n  requestId: string\n  message: string | EIP712TypedData\n  method: Methods.signMessage | Methods.signTypedMessage\n}\n\nconst INITIAL_MODAL_STATE: StateType = {\n  isOpen: false,\n  message: '',\n  requestId: '',\n  method: Methods.signMessage,\n}\n\ntype ReturnType = [\n  StateType,\n  (message: string | EIP712TypedData, requestId: string, method: Methods) => void,\n  () => void,\n]\n\nexport const useSignMessageModal = (): ReturnType => {\n  const [signMessageModalState, setSignMessageModalState] = useState<StateType>(INITIAL_MODAL_STATE)\n\n  const openSignMessageModal = useCallback(\n    (message: string | EIP712TypedData, requestId: string, method: Methods.signTypedMessage | Methods.signMessage) => {\n      setSignMessageModalState({\n        ...INITIAL_MODAL_STATE,\n        isOpen: true,\n        message,\n        requestId,\n        method,\n      })\n    },\n    [],\n  )\n\n  const closeSignMessageModal = useCallback(() => {\n    setSignMessageModalState(INITIAL_MODAL_STATE)\n  }, [])\n\n  return [signMessageModalState, openSignMessageModal, closeSignMessageModal]\n}\n","import styled from 'styled-components'\nimport IconButton from '@material-ui/core/IconButton'\nimport Close from '@material-ui/icons/Close'\nimport { Icon } from '@gnosis.pm/safe-react-components'\n\nimport Paragraph from 'src/components/layout/Paragraph'\nimport { md, lg } from 'src/theme/variables'\nimport Row from 'src/components/layout/Row'\n\nconst StyledParagraph = styled(Paragraph)`\n  && {\n    font-size: ${lg};\n    white-space: nowrap;\n    max-width: 370px;\n    overflow: hidden;\n  }\n`\nconst IconImg = styled.img`\n  width: 20px;\n  margin-right: 10px;\n`\nconst TitleWrapper = styled.div`\n  display: flex;\n  align-items: center;\n`\n\nconst StyledRow = styled(Row)`\n  padding: ${md} ${lg};\n  justify-content: space-between;\n  box-sizing: border-box;\n  max-height: 75px;\n`\n\nconst StyledClose = styled(Close)`\n  height: 35px;\n  width: 35px;\n`\n\nconst GoBackWrapper = styled.div`\n  margin-right: 15px;\n`\n\ntype Props = {\n  title: string\n  goBack?: () => void\n  iconUrl?: string\n  onClose?: () => void\n}\n\nconst ModalTitle = ({ goBack, iconUrl, title, onClose }: Props): React.ReactElement => {\n  return (\n    <StyledRow align=\"center\" grow>\n      <TitleWrapper>\n        {goBack && (\n          <GoBackWrapper>\n            <IconButton onClick={goBack}>\n              <Icon type=\"arrowLeft\" size=\"md\" />\n            </IconButton>\n          </GoBackWrapper>\n        )}\n        {iconUrl && <IconImg alt={title} src={iconUrl} />}\n        <StyledParagraph noMargin weight=\"bolder\" title={title}>\n          {title}\n        </StyledParagraph>\n      </TitleWrapper>\n      <IconButton disableRipple onClick={onClose}>\n        <StyledClose />\n      </IconButton>\n    </StyledRow>\n  )\n}\n\nexport default ModalTitle\n","import { Operation } from '@gnosis.pm/safe-react-gateway-sdk'\nimport { Icon, Text } from '@gnosis.pm/safe-react-components'\nimport MuiTextField from '@material-ui/core/TextField'\nimport { ReactElement } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled from 'styled-components'\n\nimport ModalTitle from 'src/components/ModalTitle'\nimport { createTransaction } from 'src/logic/safe/store/actions/createTransaction'\nimport { TX_NOTIFICATION_TYPES } from 'src/logic/safe/transactions'\nimport { getExplorerInfo, getNativeCurrency } from 'src/config'\nimport { lg, md } from 'src/theme/variables'\nimport { TxParameters } from 'src/routes/safe/container/hooks/useTransactionParameters'\nimport { BasicTxInfo } from 'src/components/DecodeTxs'\nimport Block from 'src/components/layout/Block'\nimport Divider from 'src/components/Divider'\nimport { SignMessageModalProps } from '.'\nimport Hairline from 'src/components/layout/Hairline'\nimport { grantedSelector } from 'src/routes/safe/container/selector'\nimport Paragraph from 'src/components/layout/Paragraph'\nimport PrefixedEthHashInfo from 'src/components/PrefixedEthHashInfo'\nimport { TxModalWrapper } from 'src/routes/safe/components/Transactions/helpers/TxModalWrapper'\n\nconst Container = styled.div`\n  max-width: 480px;\n  padding: ${md} ${lg} 0;\n`\n\nconst StyledBlock = styled(Block)`\n  background-color: ${({ theme }) => theme.colors.separator};\n  width: fit-content;\n  padding: 5px 10px;\n  border-radius: 3px;\n  margin: 4px 0 0 40px;\n\n  display: flex;\n\n  > :nth-child(1) {\n    margin-right: 5px;\n  }\n`\n\nconst MessageTextArea = styled(MuiTextField)`\n  &.MuiFormControl-root {\n    padding-bottom: ${({ theme }) => theme.margin.md};\n  }\n`\n\nconst InfoMessage = styled(Paragraph)`\n  display: flex;\n  align-items: center;\n\n  > span:first-child {\n    margin-right: ${({ theme }) => theme.margin.xs};\n  }\n`\n\ntype Props = Omit<SignMessageModalProps, 'message' | 'isOpen'> & {\n  txData: string\n  txRecipient: string\n  utf8Message: string\n}\n\nexport const ReviewMessage = ({\n  app,\n  safeAddress,\n  ethBalance,\n  safeName,\n  onUserConfirm,\n  onClose,\n  onTxReject,\n  requestId,\n  method,\n  utf8Message,\n  txData,\n  txRecipient,\n}: Props): ReactElement => {\n  const dispatch = useDispatch()\n  const explorerUrl = getExplorerInfo(safeAddress)\n  const nativeCurrency = getNativeCurrency()\n  const isOwner = useSelector(grantedSelector)\n\n  const handleTxRejection = () => {\n    onTxReject(requestId)\n    onClose()\n  }\n\n  const handleUserConfirmation = (safeTxHash: string): void => {\n    onUserConfirm(safeTxHash, requestId)\n    onClose()\n  }\n\n  const confirmTransactions = (txParameters: TxParameters, delayExecution: boolean) => {\n    dispatch(\n      createTransaction(\n        {\n          safeAddress,\n          to: txRecipient,\n          valueInWei: '0',\n          txData,\n          operation: Operation.DELEGATE,\n          origin: app.id,\n          navigateToTransactionsTab: false,\n          txNonce: txParameters.safeNonce,\n          safeTxGas: txParameters.safeTxGas,\n          ethParameters: txParameters,\n          notifiedTransaction: TX_NOTIFICATION_TYPES.STANDARD_TX,\n          delayExecution,\n        },\n        handleUserConfirmation,\n        handleTxRejection,\n      ),\n    )\n  }\n\n  return (\n    <TxModalWrapper\n      txData={txData}\n      txTo={txRecipient}\n      onSubmit={confirmTransactions}\n      onClose={handleTxRejection}\n      operation={Operation.DELEGATE}\n      isSubmitDisabled={!isOwner}\n    >\n      <ModalTitle title={app.name} iconUrl={app.iconUrl} onClose={handleTxRejection} />\n\n      <Hairline />\n\n      <Container>\n        {/* Safe */}\n        <PrefixedEthHashInfo\n          name={safeName}\n          hash={safeAddress}\n          strongName\n          showAvatar\n          showCopyBtn\n          explorerUrl={explorerUrl}\n        />\n        <StyledBlock>\n          <Text size=\"md\">Balance:</Text>\n          <Text size=\"md\" strong>{`${ethBalance} ${nativeCurrency.symbol}`}</Text>\n        </StyledBlock>\n        <Divider withArrow />\n        <BasicTxInfo\n          txRecipient={txRecipient}\n          txData={txData}\n          txValue=\"0\"\n          signMethod={method.toString()}\n          recipientName=\"SignMessageLib\"\n        />\n        <Text size=\"lg\" strong>\n          Signing message:\n        </Text>\n        <MessageTextArea\n          rows=\"2\"\n          multiline\n          disabled\n          fullWidth\n          label=\"Message to sign\"\n          inputProps={{\n            type: 'text',\n            value: utf8Message,\n            name: 'Message to sign',\n            onChange: () => {},\n            placeholder: '',\n          }}\n          InputProps={{\n            disableUnderline: true,\n          }}\n        />\n        <InfoMessage>\n          <Icon size=\"md\" type=\"info\" color=\"warning\" />\n          Signing a message with the Safe requires a transaction on the blockchain\n        </InfoMessage>\n      </Container>\n    </TxModalWrapper>\n  )\n}\n","import { RequestId, Methods, EIP712TypedData, isObjectEIP712TypedData } from '@gnosis.pm/safe-apps-sdk'\nimport { ReactElement } from 'react'\nimport { useSelector } from 'react-redux'\nimport { hexToUtf8, isHexStrict } from 'web3-utils'\n\nimport { getWeb3ReadOnly } from 'src/logic/wallets/getWeb3'\nimport { ZERO_ADDRESS } from 'src/logic/wallets/ethAddresses'\nimport { getSignMessageLibContractInstance, getSignMessageLibAddress } from 'src/logic/contracts/safeContracts'\nimport Modal from 'src/components/Modal'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport { ReviewMessage } from './ReviewMessage'\nimport { currentChainId } from 'src/logic/config/store/selectors'\n\nimport { _TypedDataEncoder } from '@ethersproject/hash'\n\nexport type SignMessageModalProps = {\n  isOpen: boolean\n  app: SafeApp\n  message: string | EIP712TypedData\n  safeAddress: string\n  safeName: string\n  requestId: RequestId\n  method: string\n  ethBalance: string\n  onUserConfirm: (safeTxHash: string, requestId: RequestId) => void\n  onTxReject: (requestId: RequestId) => void\n  onClose: () => void\n}\n\nconst convertToHumanReadableMessage = (message: string): string => {\n  const isHex = isHexStrict(message.toString())\n\n  let humanReadableMessage = message\n  if (isHex) {\n    try {\n      humanReadableMessage = hexToUtf8(message)\n    } catch (e) {\n      // do nothing\n    }\n  }\n\n  return humanReadableMessage\n}\n\nexport const SignMessageModal = ({ message, isOpen, method, ...rest }: SignMessageModalProps): ReactElement | null => {\n  const web3 = getWeb3ReadOnly()\n  const networkId = useSelector(currentChainId)\n  const txRecipient = getSignMessageLibAddress(networkId) || ZERO_ADDRESS\n  let txData, readableData\n  if (method == Methods.signMessage && typeof message === 'string') {\n    txData = getSignMessageLibContractInstance(web3, networkId)\n      .methods.signMessage(web3.eth.accounts.hashMessage(message))\n      .encodeABI()\n    readableData = convertToHumanReadableMessage(message)\n  } else if (method == Methods.signTypedMessage) {\n    try {\n      if (!isObjectEIP712TypedData(message)) {\n        throw new Error('Invalid typed data')\n      }\n      readableData = JSON.stringify(message, undefined, 4)\n    } catch (e) {\n      // As the signing method is SignTypedMessage, the message should be a valid JSON.\n      // When it is not, we will reject the tx and close the modal.\n      rest.onTxReject(rest.requestId)\n      rest.onClose()\n      return null\n    }\n    const typesCopy = { ...message.types }\n\n    // We need to remove the EIP712Domain type from the types object\n    // Because it's a part of the JSON-RPC payload, but for the `.hash` in ethers.js\n    // The types are not allowed to be recursive, so ever type must either be used by another type, or be\n    // the primary type. And there must only be one type that is not used by any other type.\n    delete typesCopy.EIP712Domain\n    txData = getSignMessageLibContractInstance(web3, networkId)\n      .methods.signMessage(_TypedDataEncoder.hash(message.domain, typesCopy, message.message))\n      .encodeABI()\n  } else {\n    // Unsupported method\n    rest.onTxReject(rest.requestId)\n    rest.onClose()\n  }\n\n  return (\n    <Modal description=\"Safe App transaction\" title=\"Safe App transaction\" open={isOpen}>\n      <ReviewMessage {...rest} txRecipient={txRecipient} method={method} txData={txData} utf8Message={readableData} />\n    </Modal>\n  )\n}\n","import React from 'react'\nimport MuiAlert from '@material-ui/lab/Alert'\nimport MuiAlertTitle from '@material-ui/lab/AlertTitle'\nimport { Link } from '@gnosis.pm/safe-react-components'\n\ntype Props = {\n  onClose: () => void\n}\n\nconst HELP_LINK =\n  'https://help.gnosis-safe.io/en/articles/5955031-why-do-i-need-to-enable-third-party-cookies-for-safe-apps'\n\nexport const ThirdPartyCookiesWarning = ({ onClose }: Props): React.ReactElement => {\n  return (\n    <MuiAlert severity=\"warning\" onClose={onClose}>\n      <MuiAlertTitle>\n        Third party cookies are disabled. Safe Apps may therefore not work properly. You can find out more information\n        about this{' '}\n        <Link href={HELP_LINK} size=\"xl\" target=\"_blank\">\n          here\n        </Link>\n      </MuiAlertTitle>\n    </MuiAlert>\n  )\n}\n","import { ReactElement } from 'react'\nimport styled from 'styled-components'\nimport { PermissionRequest } from '@gnosis.pm/safe-apps-sdk/dist/src/types/permissions'\nimport { Text } from '@gnosis.pm/safe-react-components'\nimport { Divider } from '@material-ui/core'\n\nimport { Modal } from 'src/components/Modal'\nimport { SAFE_PERMISSIONS_TEXTS } from 'src/routes/safe/components/Apps/hooks/permissions'\n\ninterface PermissionsPromptProps {\n  origin: string\n  isOpen: boolean\n  requestId: string\n  permissions: PermissionRequest[]\n  onReject: (requestId?: string) => void\n  onAccept: (origin: string, requestId: string) => void\n}\n\nconst PermissionsPrompt = ({\n  origin,\n  isOpen,\n  requestId,\n  permissions,\n  onReject,\n  onAccept,\n}: PermissionsPromptProps): ReactElement => {\n  return (\n    <Modal\n      description=\"Requested permissions\"\n      handleClose={onReject}\n      open={isOpen}\n      title=\"Requested permissions\"\n      style={{ top: '25%' }}\n    >\n      <Container>\n        <Modal.Header onClose={onReject}>\n          <Modal.Header.Title>Permissions Request</Modal.Header.Title>\n        </Modal.Header>\n        <Divider />\n        <Modal.Body>\n          <Text size=\"xl\">\n            <b>{origin}</b> is requesting permissions for:\n          </Text>\n          <ul>\n            {permissions.map((permission, index) => (\n              <li key={index}>\n                <Text size=\"xl\">{SAFE_PERMISSIONS_TEXTS[Object.keys(permission)[0]].description}</Text>\n              </li>\n            ))}\n          </ul>\n        </Modal.Body>\n        <Modal.Footer>\n          <Modal.Footer.Buttons\n            cancelButtonProps={{\n              text: 'Reject',\n              color: 'error',\n              variant: 'contained',\n              onClick: () => onReject(requestId),\n            }}\n            confirmButtonProps={{ text: 'Accept', color: 'primary', onClick: () => onAccept(origin, requestId) }}\n          />\n        </Modal.Footer>\n      </Container>\n    </Modal>\n  )\n}\n\nconst Container = styled.div`\n  .modal-body {\n    min-height: auto;\n  }\n\n  .modal-footer {\n    border-top: 0;\n  }\n`\n\nexport default PermissionsPrompt\n","import { useState, useEffect } from 'react'\nimport { logError, Errors } from 'src/logic/exceptions/CodedException'\nimport { getAppInfoFromUrl, getEmptySafeApp } from '../utils'\nimport { SafeApp } from '../types'\n\ntype UseSafeAppFromManifestReturnType = {\n  safeApp: SafeApp\n  isLoading: boolean\n}\n\nconst useSafeAppFromManifest = (appUrl: string): UseSafeAppFromManifestReturnType => {\n  const [safeApp, setSafeApp] = useState<SafeApp>(() => getEmptySafeApp(appUrl))\n  const [isLoading, setIsLoading] = useState(false)\n\n  useEffect(() => {\n    if (!appUrl) {\n      return\n    }\n\n    const loadApp = async () => {\n      setIsLoading(true)\n      try {\n        const app = await getAppInfoFromUrl(appUrl)\n        setSafeApp(app)\n      } catch (e) {\n        logError(Errors._900, `${appUrl}, ${e.message}`)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    loadApp()\n  }, [appUrl])\n\n  return { safeApp, isLoading }\n}\n\nexport { useSafeAppFromManifest }\n","import { ReactElement, useState, useRef, useCallback, useEffect, useMemo } from 'react'\nimport styled from 'styled-components'\nimport { Loader, Card, Title } from '@gnosis.pm/safe-react-components'\nimport {\n  GetBalanceParams,\n  GetTxBySafeTxHashParams,\n  MethodToResponse,\n  RPCPayload,\n  Methods,\n  SignMessageParams,\n  RequestId,\n  SignTypedMessageParams,\n} from '@gnosis.pm/safe-apps-sdk'\nimport { useSelector } from 'react-redux'\nimport { INTERFACE_MESSAGES, Transaction, LowercaseNetworks } from '@gnosis.pm/safe-apps-sdk-v1'\nimport { PermissionRequest } from '@gnosis.pm/safe-apps-sdk/dist/src/types/permissions'\nimport Web3 from 'web3'\n\nimport { currentSafe } from 'src/logic/safe/store/selectors'\nimport { getChainInfo, getSafeAppsRpcServiceUrl, getTxServiceUrl } from 'src/config'\nimport { isSameURL } from 'src/utils/url'\nimport { LoadingContainer } from 'src/components/LoaderContainer/index'\nimport { SAFE_POLLING_INTERVAL } from 'src/utils/constants'\nimport { ConfirmTxModal } from './ConfirmTxModal'\nimport { useIframeMessageHandler } from '../hooks/useIframeMessageHandler'\nimport { LegacyMethods, useAppCommunicator } from '../communicator'\nimport { PermissionStatus, SafeApp } from '../types'\nimport { EMPTY_SAFE_APP, getLegacyChainName } from '../utils'\nimport { fetchTokenCurrenciesBalances } from 'src/logic/safe/api/fetchTokenCurrenciesBalances'\nimport { fetchSafeTransaction } from 'src/logic/safe/transactions/api/fetchSafeTransaction'\nimport { addressBookEntryName } from 'src/logic/addressBook/store/selectors'\nimport { useSignMessageModal } from '../hooks/useSignMessageModal'\nimport { SignMessageModal } from './SignMessageModal'\nimport { web3HttpProviderOptions } from 'src/logic/wallets/getWeb3'\nimport { useThirdPartyCookies } from '../hooks/useThirdPartyCookies'\nimport { ThirdPartyCookiesWarning } from './ThirdPartyCookiesWarning'\nimport { grantedSelector } from 'src/routes/safe/container/selector'\nimport { currentNetworkAddressBook } from 'src/logic/addressBook/store/selectors'\nimport { SAFE_APPS_EVENTS } from 'src/utils/events/safeApps'\nimport { trackEvent } from 'src/utils/googleTagManager'\nimport { checksumAddress } from 'src/utils/checksumAddress'\nimport { useRemoteSafeApps } from 'src/routes/safe/components/Apps/hooks/appList/useRemoteSafeApps'\nimport { trackSafeAppOpenCount } from 'src/routes/safe/components/Apps/trackAppUsageCount'\nimport PermissionsPrompt from 'src/routes/safe/components/Apps/components/PermissionsPrompt'\nimport { useSafeAppFromManifest } from 'src/routes/safe/components/Apps/hooks/useSafeAppFromManifest'\nimport { useSafePermissions } from 'src/routes/safe/components/Apps/hooks/permissions'\n\nconst AppWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: calc(100% + 16px);\n  margin: -8px -24px;\n`\n\nconst StyledCard = styled(Card)`\n  flex-grow: 1;\n  padding: 0;\n  border-radius: 0;\n`\n\nconst StyledIframe = styled.iframe<{ isLoading: boolean }>`\n  height: 100%;\n  width: 100%;\n  overflow: auto;\n  box-sizing: border-box;\n  display: ${({ isLoading }) => (isLoading ? 'none' : 'block')};\n`\n\nexport type TransactionParams = {\n  safeTxGas?: number\n}\n\ntype ConfirmTransactionModalState = {\n  isOpen: boolean\n  txs: Transaction[]\n  requestId: RequestId\n  params?: TransactionParams\n}\n\ntype Props = {\n  appUrl: string\n  allowedFeaturesList: string\n}\n\nconst APP_LOAD_ERROR_TIMEOUT = 30000\n\nconst INITIAL_CONFIRM_TX_MODAL_STATE: ConfirmTransactionModalState = {\n  isOpen: false,\n  txs: [],\n  requestId: '',\n  params: undefined,\n}\n\nconst URL_NOT_PROVIDED_ERROR = 'App url No provided or it is invalid.'\nconst APP_LOAD_ERROR = 'There was an error loading the Safe App. There might be a problem with the App provider.'\n\nconst AppFrame = ({ appUrl, allowedFeaturesList }: Props): ReactElement => {\n  const { address: safeAddress, ethBalance, owners, threshold } = useSelector(currentSafe)\n  const { nativeCurrency, chainId, chainName, shortName, blockExplorerUriTemplate } = getChainInfo()\n  const safeName = useSelector((state) => addressBookEntryName(state, { address: safeAddress }))\n  const granted = useSelector(grantedSelector)\n  const addressBook = useSelector(currentNetworkAddressBook)\n  const iframeRef = useRef<HTMLIFrameElement>(null)\n  const [confirmTransactionModal, setConfirmTransactionModal] =\n    useState<ConfirmTransactionModalState>(INITIAL_CONFIRM_TX_MODAL_STATE)\n  const [appIsLoading, setAppIsLoading] = useState<boolean>(true)\n  const [signMessageModalState, openSignMessageModal, closeSignMessageModal] = useSignMessageModal()\n  const timer = useRef<number>()\n  const [isLoadingSlow, setIsLoadingSlow] = useState<boolean>(false)\n  const errorTimer = useRef<number>()\n  const [, setAppLoadError] = useState<boolean>(false)\n  const { thirdPartyCookiesDisabled, setThirdPartyCookiesDisabled } = useThirdPartyCookies()\n  const { remoteSafeApps } = useRemoteSafeApps()\n  const currentApp = remoteSafeApps.filter((app) => app.url === appUrl)[0]\n  const { confirmPermissionRequest, permissionsRequest, setPermissionsRequest, getPermissions, hasPermission } =\n    useSafePermissions()\n  const safeAppsRpc = getSafeAppsRpcServiceUrl()\n  const safeAppWeb3Provider = useMemo(\n    () => new Web3.providers.HttpProvider(safeAppsRpc, web3HttpProviderOptions),\n    [safeAppsRpc],\n  )\n  const { safeApp } = useSafeAppFromManifest(appUrl)\n\n  useEffect(() => {\n    const clearTimeouts = () => {\n      clearTimeout(timer.current)\n      clearTimeout(errorTimer.current)\n    }\n\n    if (appIsLoading) {\n      timer.current = window.setTimeout(() => {\n        setIsLoadingSlow(true)\n      }, SAFE_POLLING_INTERVAL)\n      errorTimer.current = window.setTimeout(() => {\n        setAppLoadError(() => {\n          throw Error(APP_LOAD_ERROR)\n        })\n      }, APP_LOAD_ERROR_TIMEOUT)\n    } else {\n      clearTimeouts()\n      setIsLoadingSlow(false)\n    }\n\n    return () => {\n      clearTimeouts()\n    }\n  }, [appIsLoading])\n\n  useEffect(() => {\n    if (!currentApp) return\n\n    trackSafeAppOpenCount(currentApp.id)\n  }, [currentApp])\n\n  const openConfirmationModal = useCallback(\n    (txs: Transaction[], params: TransactionParams | undefined, requestId: RequestId) =>\n      setConfirmTransactionModal({\n        isOpen: true,\n        txs,\n        requestId,\n        params,\n      }),\n    [setConfirmTransactionModal],\n  )\n  const closeConfirmationModal = useCallback(\n    () => setConfirmTransactionModal(INITIAL_CONFIRM_TX_MODAL_STATE),\n    [setConfirmTransactionModal],\n  )\n\n  const { sendMessageToIframe } = useIframeMessageHandler(\n    safeApp,\n    openConfirmationModal,\n    closeConfirmationModal,\n    iframeRef,\n  )\n\n  const onIframeLoad = useCallback(() => {\n    const iframe = iframeRef.current\n    if (!iframe || !isSameURL(iframe.src, appUrl as string)) {\n      return\n    }\n\n    setAppIsLoading(false)\n    sendMessageToIframe({\n      messageId: INTERFACE_MESSAGES.ON_SAFE_INFO,\n      data: {\n        safeAddress: safeAddress as string,\n        // FIXME `network` is deprecated. we should find how many apps are still using it\n        network: getLegacyChainName(chainName, chainId).toLowerCase() as LowercaseNetworks,\n        ethBalance: ethBalance as string,\n      },\n    })\n  }, [chainName, chainId, ethBalance, safeAddress, appUrl, sendMessageToIframe])\n\n  const communicator = useAppCommunicator(iframeRef, safeApp)\n\n  useEffect(() => {\n    /**\n     * @deprecated: getEnvInfo is a legacy method. Should not be used\n     */\n    communicator?.on(LegacyMethods.getEnvInfo, () => ({\n      txServiceUrl: getTxServiceUrl(),\n    }))\n\n    communicator?.on(Methods.getTxBySafeTxHash, async (msg) => {\n      const { safeTxHash } = msg.data.params as GetTxBySafeTxHashParams\n\n      const tx = await fetchSafeTransaction(safeTxHash)\n\n      return tx\n    })\n\n    communicator?.on(Methods.getEnvironmentInfo, async () => ({\n      origin: document.location.origin,\n    }))\n\n    communicator?.on(Methods.getSafeInfo, () => ({\n      safeAddress,\n      // FIXME `network` is deprecated. we should find how many apps are still using it\n      // Apps using this property expect this to be in UPPERCASE\n      network: getLegacyChainName(chainName, chainId).toUpperCase(),\n      chainId: parseInt(chainId, 10),\n      owners,\n      threshold,\n      isReadOnly: !granted,\n    }))\n\n    communicator?.on(Methods.getSafeBalances, async (msg) => {\n      const { currency = 'usd' } = msg.data.params as GetBalanceParams\n\n      const balances = await fetchTokenCurrenciesBalances({ safeAddress, selectedCurrency: currency })\n\n      return balances\n    })\n\n    communicator?.on(Methods.wallet_getPermissions, (msg) => {\n      return getPermissions(msg.origin)\n    })\n\n    communicator?.on(Methods.wallet_requestPermissions, async (msg) => {\n      setPermissionsRequest({\n        origin: msg.origin,\n        request: msg.data.params as PermissionRequest[],\n        requestId: msg.data.id,\n      })\n    })\n\n    communicator?.on(Methods.requestAddressBook, async (msg) => {\n      if (hasPermission(msg.origin, Methods.requestAddressBook)) {\n        return addressBook\n      }\n\n      return []\n    })\n\n    communicator?.on(Methods.rpcCall, async (msg) => {\n      const params = msg.data.params as RPCPayload\n\n      try {\n        const response = new Promise<MethodToResponse['rpcCall']>((resolve, reject) => {\n          safeAppWeb3Provider.send(\n            {\n              jsonrpc: '2.0',\n              method: params.call,\n              params: params.params,\n              id: '1',\n            },\n            (err, res) => {\n              if (err || res?.error) {\n                reject(err || res?.error)\n              }\n\n              resolve(res?.result)\n            },\n          )\n        })\n\n        return response\n      } catch (err) {\n        return err\n      }\n    })\n\n    communicator?.on(Methods.sendTransactions, (msg) => {\n      // @ts-expect-error explore ways to fix this\n      const transactions = (msg.data.params.txs as Transaction[]).map(({ to, ...rest }) => ({\n        to: checksumAddress(to),\n        ...rest,\n      }))\n      // @ts-expect-error explore ways to fix this\n      openConfirmationModal(transactions, msg.data.params.params, msg.data.id)\n    })\n\n    communicator?.on(Methods.signMessage, async (msg) => {\n      const { message } = msg.data.params as SignMessageParams\n\n      openSignMessageModal(message, msg.data.id, Methods.signMessage)\n    })\n\n    communicator?.on(Methods.signTypedMessage, async (msg) => {\n      const { typedData } = msg.data.params as SignTypedMessageParams\n\n      openSignMessageModal(typedData, msg.data.id, Methods.signTypedMessage)\n    })\n\n    communicator?.on(Methods.getChainInfo, async () => {\n      return {\n        chainName,\n        chainId,\n        shortName,\n        nativeCurrency,\n        blockExplorerUriTemplate,\n      }\n    })\n  }, [\n    communicator,\n    openConfirmationModal,\n    safeAddress,\n    owners,\n    threshold,\n    openSignMessageModal,\n    nativeCurrency,\n    chainId,\n    chainName,\n    shortName,\n    safeAppWeb3Provider,\n    granted,\n    blockExplorerUriTemplate,\n    addressBook,\n    getPermissions,\n    setPermissionsRequest,\n    hasPermission,\n  ])\n\n  const onUserTxConfirm = (safeTxHash: string, requestId: RequestId) => {\n    // Safe Apps SDK V1 Handler\n    sendMessageToIframe(\n      { messageId: INTERFACE_MESSAGES.TRANSACTION_CONFIRMED, data: { safeTxHash } },\n      confirmTransactionModal.requestId,\n    )\n\n    // Safe Apps SDK V2 Handler\n    communicator?.send({ safeTxHash }, requestId as string)\n\n    trackEvent({ ...SAFE_APPS_EVENTS.TRANSACTION_CONFIRMED, label: safeApp.name })\n  }\n\n  const onTxReject = (requestId: RequestId) => {\n    // Safe Apps SDK V1 Handler\n    sendMessageToIframe(\n      { messageId: INTERFACE_MESSAGES.TRANSACTION_REJECTED, data: {} },\n      confirmTransactionModal.requestId,\n    )\n\n    // Safe Apps SDK V2 Handler\n    communicator?.send('Transaction was rejected', requestId as string, true)\n\n    trackEvent({ ...SAFE_APPS_EVENTS.TRANSACTION_REJECTED, label: safeApp.name })\n  }\n\n  const onAcceptPermissionRequest = (origin: string, requestId: RequestId) => {\n    const permissions = confirmPermissionRequest(PermissionStatus.GRANTED)\n    communicator?.send(permissions, requestId as string)\n  }\n\n  const onRejectPermissionRequest = (requestId: RequestId) => {\n    if (requestId) {\n      confirmPermissionRequest(PermissionStatus.DENIED)\n      communicator?.send('Permissions were rejected', requestId as string, true)\n    } else {\n      setPermissionsRequest(undefined)\n    }\n  }\n\n  useEffect(() => {\n    if (!appUrl) {\n      throw Error(URL_NOT_PROVIDED_ERROR)\n    }\n  }, [appUrl])\n\n  useEffect(() => {\n    if (safeApp && safeApp.name !== EMPTY_SAFE_APP) {\n      trackEvent({ ...SAFE_APPS_EVENTS.OPEN_APP, label: safeApp.name })\n    }\n  }, [safeApp])\n\n  return (\n    <AppWrapper>\n      {thirdPartyCookiesDisabled && <ThirdPartyCookiesWarning onClose={() => setThirdPartyCookiesDisabled(false)} />}\n      <StyledCard>\n        {appIsLoading && (\n          <LoadingContainer style={{ flexDirection: 'column' }}>\n            {isLoadingSlow && <Title size=\"xs\">The Safe App is taking too long to load, consider refreshing.</Title>}\n            <Loader size=\"md\" />\n          </LoadingContainer>\n        )}\n\n        <StyledIframe\n          isLoading={appIsLoading}\n          frameBorder=\"0\"\n          id={`iframe-${appUrl}`}\n          ref={iframeRef}\n          src={appUrl}\n          title={safeApp.name}\n          onLoad={onIframeLoad}\n          allow={allowedFeaturesList}\n        />\n      </StyledCard>\n\n      <ConfirmTxModal\n        isOpen={confirmTransactionModal.isOpen}\n        app={safeApp as SafeApp}\n        safeAddress={safeAddress}\n        ethBalance={ethBalance as string}\n        safeName={safeName as string}\n        txs={confirmTransactionModal.txs}\n        onClose={closeConfirmationModal}\n        requestId={confirmTransactionModal.requestId}\n        onUserConfirm={onUserTxConfirm}\n        params={confirmTransactionModal.params}\n        onTxReject={onTxReject}\n        appId={currentApp?.id}\n      />\n\n      <SignMessageModal\n        isOpen={signMessageModalState.isOpen}\n        app={safeApp as SafeApp}\n        safeAddress={safeAddress}\n        ethBalance={ethBalance as string}\n        safeName={safeName as string}\n        onClose={closeSignMessageModal}\n        requestId={signMessageModalState.requestId}\n        message={signMessageModalState.message}\n        method={signMessageModalState.method}\n        onUserConfirm={onUserTxConfirm}\n        onTxReject={onTxReject}\n      />\n\n      {permissionsRequest && (\n        <PermissionsPrompt\n          isOpen\n          origin={permissionsRequest.origin}\n          requestId={permissionsRequest.requestId}\n          onAccept={onAcceptPermissionRequest}\n          onReject={onRejectPermissionRequest}\n          permissions={permissionsRequest.request}\n        />\n      )}\n    </AppWrapper>\n  )\n}\n\nexport default AppFrame\n","import {\n  InterfaceMessageIds,\n  InterfaceMessageToPayload,\n  SDKMessageIds,\n  SDKMessageToPayload,\n  SDK_MESSAGES,\n  INTERFACE_MESSAGES,\n  RequestId,\n  Transaction,\n  LowercaseNetworks,\n} from '@gnosis.pm/safe-apps-sdk-v1'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { useEffect, useCallback, MutableRefObject } from 'react'\n\nimport { getChainInfo, getTxServiceUrl } from 'src/config/'\nimport { currentSafeWithNames } from 'src/logic/safe/store/selectors'\nimport { TransactionParams } from '../components/AppFrame'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport { getLegacyChainName } from '../utils'\nimport { THIRD_PARTY_COOKIES_CHECK_URL } from './useThirdPartyCookies'\nimport { getSafeAppName, trackEvent } from 'src/utils/googleTagManager'\nimport { SAFE_APPS_EVENTS } from 'src/utils/events/safeApps'\n\ntype InterfaceMessageProps<T extends InterfaceMessageIds> = {\n  messageId: T\n  data: InterfaceMessageToPayload[T]\n}\n\ntype ReturnType = {\n  sendMessageToIframe: <T extends InterfaceMessageIds>(message: InterfaceMessageProps<T>, requestId?: RequestId) => void\n}\n\nconst useIframeMessageHandler = (\n  selectedApp: SafeApp | undefined,\n  openConfirmationModal: (txs: Transaction[], params: TransactionParams | undefined, requestId: RequestId) => void,\n  closeModal: () => void,\n  iframeRef: MutableRefObject<HTMLIFrameElement | null>,\n): ReturnType => {\n  const { address: safeAddress, ethBalance, name: safeName } = useSelector(currentSafeWithNames)\n  const dispatch = useDispatch()\n  const { chainId, chainName } = getChainInfo()\n\n  const sendMessageToIframe = useCallback(\n    function <T extends InterfaceMessageIds>(message: InterfaceMessageProps<T>, requestId?: RequestId) {\n      const requestWithMessage = {\n        ...message,\n        requestId: requestId || Math.trunc(window.performance.now()),\n        version: '0.4.2',\n      }\n\n      if (iframeRef && selectedApp) {\n        iframeRef.current?.contentWindow?.postMessage(requestWithMessage, selectedApp.url)\n      }\n    },\n    [iframeRef, selectedApp],\n  )\n\n  useEffect(() => {\n    const handleIframeMessage = (\n      messageId: SDKMessageIds,\n      messagePayload: SDKMessageToPayload[typeof messageId],\n      requestId: RequestId,\n    ): void => {\n      if (!messageId) {\n        return\n      }\n\n      trackEvent({ ...SAFE_APPS_EVENTS.LEGACY_API_CALL, label: `${getSafeAppName(selectedApp)}-${messageId}` })\n\n      switch (messageId) {\n        // typescript doesn't narrow type in switch/case statements\n        // issue: https://github.com/microsoft/TypeScript/issues/20375\n        // possible solution: https://stackoverflow.com/a/43879897/7820085\n        case SDK_MESSAGES.SEND_TRANSACTIONS: {\n          if (messagePayload) {\n            openConfirmationModal(\n              messagePayload as SDKMessageToPayload[typeof SDK_MESSAGES.SEND_TRANSACTIONS],\n              undefined,\n              requestId,\n            )\n          }\n          break\n        }\n\n        case SDK_MESSAGES.SAFE_APP_SDK_INITIALIZED: {\n          const safeInfoMessage = {\n            messageId: INTERFACE_MESSAGES.ON_SAFE_INFO,\n            data: {\n              safeAddress: safeAddress as string,\n              network: getLegacyChainName(chainName, chainId).toLowerCase() as LowercaseNetworks,\n              ethBalance: ethBalance as string,\n            },\n          }\n          const envInfoMessage = {\n            messageId: INTERFACE_MESSAGES.ENV_INFO,\n            data: {\n              txServiceUrl: getTxServiceUrl(),\n            },\n          }\n\n          sendMessageToIframe(safeInfoMessage)\n          sendMessageToIframe(envInfoMessage)\n          break\n        }\n        default: {\n          console.error(`ThirdPartyApp: A message was received with an unknown message id ${messageId}.`)\n          break\n        }\n      }\n    }\n    const onIframeMessage = async (\n      message: MessageEvent<{\n        requestId: RequestId\n        messageId: SDKMessageIds\n        data: SDKMessageToPayload[SDKMessageIds]\n      }>,\n    ) => {\n      if (message.origin === window.origin || message.origin === THIRD_PARTY_COOKIES_CHECK_URL) {\n        return\n      }\n\n      if (!selectedApp?.url.includes(message.origin)) {\n        console.error(`ThirdPartyApp: A message was received from an unknown origin ${message.origin}`)\n        return\n      }\n      handleIframeMessage(message.data.messageId, message.data.data, message.data.requestId)\n    }\n\n    window.addEventListener('message', onIframeMessage)\n    return () => {\n      window.removeEventListener('message', onIframeMessage)\n    }\n  }, [\n    chainName,\n    chainId,\n    closeModal,\n    dispatch,\n    ethBalance,\n    openConfirmationModal,\n    safeAddress,\n    safeName,\n    selectedApp,\n    sendMessageToIframe,\n  ])\n\n  return {\n    sendMessageToIframe,\n  }\n}\n\nexport { useIframeMessageHandler }\n","export default __webpack_public_path__ + \"static/media/addApp.71634f09.svg\";","import React from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport Input from '@material-ui/core/Input'\nimport SearchIcon from '@material-ui/icons/Search'\nimport ClearIcon from '@material-ui/icons/Clear'\nimport styled from 'styled-components'\nimport { Card } from '@gnosis.pm/safe-react-components'\nimport { trackEvent } from 'src/utils/googleTagManager'\nimport { SAFE_APPS_EVENTS } from 'src/utils/events/safeApps'\n\nconst Container = styled(Card)`\n  width: 100%;\n  box-sizing: border-box;\n`\n\ntype Props = {\n  value: string\n  onValueChange: (value: string) => void\n}\n\nconst SearchInputCard = ({ value, onValueChange }: Props): React.ReactElement => (\n  <Container>\n    <Input\n      inputProps={{\n        'aria-label': 'search',\n      }}\n      startAdornment={<SearchIcon />}\n      endAdornment={\n        value && (\n          <IconButton aria-label=\"Clear the search\" onClick={() => onValueChange('')}>\n            <ClearIcon />\n          </IconButton>\n        )\n      }\n      onChange={(event: React.ChangeEvent<HTMLInputElement>) => onValueChange(event.target.value)}\n      placeholder=\"e.g. Compound\"\n      value={value}\n      style={{ width: '100%' }}\n      onBlur={() => {\n        if (value) {\n          trackEvent({ ...SAFE_APPS_EVENTS.SEARCH, label: value })\n        }\n      }}\n    />\n  </Container>\n)\n\nexport { SearchInputCard }\n","import { Text, Button } from '@gnosis.pm/safe-react-components'\nimport styled from 'styled-components'\n\nconst NoAppsFoundTextContainer = styled.div`\n  max-width: 650px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: ${({ theme }) => theme.margin.xxl};\n  margin-bottom: ${({ theme }) => theme.margin.xxl};\n\n  & > p {\n    text-align: center;\n  }\n`\n\nconst SButton = styled(Button)`\n  margin-top: ${({ theme }) => theme.margin.md};\n  max-width: 300px;\n`\n\ntype Props = {\n  query: string\n  onWalletConnectSearch: () => void\n}\n\nconst NoAppsFound = ({ query, onWalletConnectSearch }: Props): React.ReactElement => (\n  <NoAppsFoundTextContainer>\n    <Text size=\"xl\">\n      No apps found matching <b>{query}</b>. Connect to dApps that haven&apos;t yet been integrated with the Safe using\n      the WalletConnect App.\n    </Text>\n    <SButton onClick={onWalletConnectSearch} size=\"md\">\n      Search WalletConnect\n    </SButton>\n  </NoAppsFoundTextContainer>\n)\n\nexport { NoAppsFound }\n","import { Checkbox, Text } from '@gnosis.pm/safe-react-components'\n\nimport { useFormState } from 'react-final-form'\nimport styled from 'styled-components'\n\nimport { required } from 'src/components/forms/validator'\nimport Field from 'src/components/forms/Field'\n\nconst StyledCheckbox = styled(Checkbox)`\n  margin: 0;\n`\n\nconst AppAgreement = (): React.ReactElement => {\n  const { visited } = useFormState({ subscription: { visited: true } })\n\n  // trick to prevent having the field validated by default. Not sure why this happens in this form\n  const validate = !visited?.agreementAccepted ? undefined : required\n\n  return (\n    <Field\n      component={StyledCheckbox}\n      label={<Text size=\"xl\">This app is not part of the Safe and I agree to use this app at my own risk.</Text>}\n      name=\"agreementAccepted\"\n      type=\"checkbox\"\n      validate={validate}\n    />\n  )\n}\n\nexport default AppAgreement\n","import { useEffect } from 'react'\nimport { TextField } from '@gnosis.pm/safe-react-components'\nimport createDecorator from 'final-form-calculate'\nimport { useField, useFormState } from 'react-final-form'\nimport styled from 'styled-components'\n\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport { getAppInfoFromUrl, getIpfsLinkFromEns, uniqueApp } from 'src/routes/safe/components/Apps/utils'\nimport { composeValidators, required } from 'src/components/forms/validator'\nimport Field from 'src/components/forms/Field'\nimport { isValidURL } from 'src/utils/url'\nimport { isValidEnsName } from 'src/logic/wallets/ethAddresses'\nimport { useDebounce } from 'src/logic/hooks/useDebounce'\n\nconst validateUrl = (url: string): string | undefined => (isValidURL(url) ? undefined : 'Invalid URL')\n\nexport const appUrlResolver = createDecorator({\n  field: 'appUrl',\n  updates: {\n    appUrl: async (appUrl: string): Promise<string | undefined> => {\n      const ensContent = !isValidURL(appUrl) && isValidEnsName(appUrl) && (await getIpfsLinkFromEns(appUrl))\n\n      if (ensContent) {\n        return ensContent\n      }\n\n      return appUrl\n    },\n  },\n})\n\ntype AppInfoUpdaterProps = {\n  onAppInfo: (appInfo: SafeApp) => unknown\n  onLoading: (isLoading: boolean) => unknown\n  onError: (error: Error) => unknown\n}\n\nexport const AppInfoUpdater = ({ onAppInfo, onLoading, onError }: AppInfoUpdaterProps): null => {\n  const {\n    input: { value: appUrl },\n  } = useField('appUrl', { subscription: { value: true } })\n\n  const debouncedValue = useDebounce(appUrl, 500)\n\n  useEffect(() => {\n    const updateAppInfo = async () => {\n      onLoading(true)\n\n      try {\n        const appInfo = await getAppInfoFromUrl(debouncedValue)\n        onAppInfo({ ...appInfo })\n      } catch (error) {\n        onError?.(error)\n      }\n\n      onLoading(false)\n    }\n\n    if (isValidURL(debouncedValue)) {\n      updateAppInfo()\n    }\n  }, [debouncedValue, onAppInfo, onError, onLoading])\n\n  return null\n}\n\nconst StyledAppUrlField = styled(Field)`\n  && {\n    width: 100%;\n  }\n`\n\nconst AppUrl = ({ appList }: { appList: SafeApp[] }): React.ReactElement => {\n  const { visited } = useFormState({ subscription: { visited: true } })\n\n  // trick to prevent having the field validated by default. Not sure why this happens in this form\n  const validate = !visited?.appUrl ? undefined : composeValidators(required, validateUrl, uniqueApp(appList))\n\n  return (\n    <StyledAppUrlField\n      label=\"App URL\"\n      name=\"appUrl\"\n      placeholder=\"App URL\"\n      type=\"text\"\n      component={TextField}\n      validate={validate}\n      autoComplete=\"off\"\n    />\n  )\n}\n\nexport default AppUrl\n","import { ReactElement, useMemo } from 'react'\nimport { useFormState } from 'react-final-form'\n\nimport { Modal } from 'src/components/Modal'\nimport { isAppManifestValid } from 'src/routes/safe/components/Apps/utils'\nimport { SafeApp } from '../../types'\n\ninterface Props {\n  appInfo: SafeApp\n  onCancel: () => void\n}\n\nexport const FormButtons = ({ appInfo, onCancel }: Props): ReactElement => {\n  const { valid, validating, visited } = useFormState({\n    subscription: { valid: true, validating: true, visited: true },\n  })\n\n  const isSubmitDisabled = useMemo(() => {\n    // if non visited, fields were not evaluated yet. Then, the default value is considered invalid\n    const fieldsVisited = visited?.agreementAccepted && visited?.appUrl\n\n    // @ts-expect-error adding this because isAppManifestValid only checks name and description which are both present in the SafeApp type\n    return validating || !valid || !fieldsVisited || !isAppManifestValid(appInfo)\n  }, [validating, valid, visited, appInfo])\n\n  return (\n    <Modal.Footer.Buttons\n      cancelButtonProps={{ onClick: onCancel }}\n      confirmButtonProps={{ disabled: isSubmitDisabled, text: 'Add' }}\n    />\n  )\n}\n","import { Icon, Link, Loader, Text, TextField } from '@gnosis.pm/safe-react-components'\nimport { useState, ReactElement, useCallback, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\nimport GnoForm from 'src/components/forms/GnoForm'\nimport Img from 'src/components/layout/Img'\nimport { Modal } from 'src/components/Modal'\nimport AppAgreement from './AppAgreement'\nimport AppUrl, { AppInfoUpdater, appUrlResolver } from './AppUrl'\nimport { FormButtons } from './FormButtons'\nimport { getEmptySafeApp } from 'src/routes/safe/components/Apps/utils'\nimport { Errors, logError } from 'src/logic/exceptions/CodedException'\nimport { generateSafeRoute, extractPrefixedSafeAddress, SAFE_ROUTES } from 'src/routes/routes'\nimport { trackEvent } from 'src/utils/googleTagManager'\nimport { SAFE_APPS_EVENTS } from 'src/utils/events/safeApps'\n\nconst FORM_ID = 'add-apps-form'\n\nconst StyledTextFileAppName = styled(TextField)`\n  && {\n    width: 385px;\n    .MuiFormLabel-root {\n      &.Mui-disabled {\n        color: rgba(0, 0, 0, 0.54);\n        &.Mui-error {\n          color: ${(props) => props.theme.colors.error};\n        }\n      }\n    }\n    .MuiInputBase-root {\n      .MuiFilledInput-input {\n        color: rgba(0, 0, 0, 0.54);\n      }\n      &:before {\n        border-bottom-style: inset;\n      }\n    }\n  }\n`\n\nconst AppInfo = styled.div`\n  display: flex;\n  margin: 36px 0 24px 0;\n\n  img {\n    margin-right: 10px;\n  }\n`\n\nconst StyledLink = styled(Link)`\n  inline-size: fit-content;\n`\n\nconst AppDocsInfo = styled.div`\n  display: flex;\n  margin-bottom: 24px;\n  flex-direction: column;\n  svg {\n    position: relative;\n    top: 4px;\n    left: 4px;\n  }\n`\n\nconst WrapperLoader = styled.div`\n  height: 55px;\n  width: 65px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst StyledLoader = styled(Loader)`\n  margin-right: 15px;\n`\n\ninterface AddAppFormValues {\n  appUrl: string\n  agreementAccepted: boolean\n}\n\nconst INITIAL_VALUES: AddAppFormValues = {\n  appUrl: '',\n  agreementAccepted: false,\n}\n\nconst DEFAULT_APP_INFO = getEmptySafeApp()\n\nconst CUSTOM_SAFE_APPS_LINK = 'https://docs.gnosis-safe.io/build/sdks/safe-apps'\n\ninterface AddAppProps {\n  appList: SafeApp[]\n  closeModal: () => void\n  onAddApp: (app: SafeApp) => void\n}\n\nconst AddApp = ({ appList, closeModal, onAddApp }: AddAppProps): ReactElement => {\n  const [appInfo, setAppInfo] = useState<SafeApp>(DEFAULT_APP_INFO)\n  const [fetchError, setFetchError] = useState<string | undefined>()\n  const history = useHistory()\n  const [isLoading, setIsLoading] = useState(false)\n\n  const handleSubmit = useCallback(async () => {\n    trackEvent(SAFE_APPS_EVENTS.ADD_CUSTOM_APP)\n    onAddApp(appInfo)\n    history.push({\n      pathname: generateSafeRoute(SAFE_ROUTES.APPS, extractPrefixedSafeAddress()),\n      search: `?appUrl=${encodeURIComponent(appInfo.url)}`,\n    })\n  }, [history, appInfo, onAddApp])\n\n  useEffect(() => {\n    if (isLoading) {\n      setFetchError(undefined)\n    }\n  }, [isLoading])\n\n  const onError = useCallback(\n    (error: Error) => {\n      setFetchError(error.message)\n      logError(Errors._903, error.message)\n      setAppInfo(DEFAULT_APP_INFO)\n    },\n    [setAppInfo],\n  )\n\n  return (\n    <GnoForm decorators={[appUrlResolver]} initialValues={INITIAL_VALUES} onSubmit={handleSubmit} testId={FORM_ID}>\n      {() => (\n        <>\n          <Modal.Body>\n            <AppDocsInfo>\n              <Text size=\"xl\" as=\"span\" color=\"secondary\">\n                Safe Apps are third-party extensions.\n              </Text>\n              <StyledLink\n                href={CUSTOM_SAFE_APPS_LINK}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                title=\"Learn more about building Safe Apps\"\n              >\n                <Text size=\"xl\" as=\"span\" color=\"primary\">\n                  Learn more about building Safe Apps.\n                </Text>\n                <Icon size=\"sm\" type=\"externalLink\" color=\"primary\" />\n              </StyledLink>\n            </AppDocsInfo>\n            <AppUrl appList={appList} />\n            {/* Fetch app from url and return a SafeApp */}\n            <AppInfoUpdater onAppInfo={setAppInfo} onLoading={setIsLoading} onError={onError} />\n            <AppInfo>\n              {isLoading ? (\n                <WrapperLoader>\n                  <StyledLoader size=\"sm\" />\n                </WrapperLoader>\n              ) : (\n                <Img alt=\"Token image\" width={55} src={appInfo.iconUrl} />\n              )}\n              <StyledTextFileAppName\n                label=\"App name\"\n                disabled\n                meta={{ error: fetchError }}\n                value={isLoading ? 'Loading...' : appInfo.name === DEFAULT_APP_INFO.name ? '' : appInfo.name}\n                onChange={() => {}}\n              />\n            </AppInfo>\n            <AppAgreement />\n          </Modal.Body>\n          <Modal.Footer>\n            <FormButtons appInfo={appInfo} onCancel={closeModal} />\n          </Modal.Footer>\n        </>\n      )}\n    </GnoForm>\n  )\n}\n\nexport default AddApp\n","import { Text } from '@gnosis.pm/safe-react-components'\nimport Card from '@material-ui/core/Card'\nimport BookmarkBorder from '@material-ui/icons/BookmarkBorder'\n\nimport styled from 'styled-components'\nimport InfoIcon from 'src/assets/icons/info.svg'\nimport Img from 'src/components/layout/Img'\n\nconst NoAppsFoundTextContainer = styled(Card)`\n  display: flex;\n  margin-top: ${({ theme }) => theme.margin.md};\n  margin-bottom: ${({ theme }) => theme.margin.md};\n  box-shadow: 1px 2px 10px 0 rgba(212, 212, 211, 0.59);\n  box-sizing: border-box;\n  max-width: 100%;\n  padding: 52px 54px;\n  justify-content: center;\n  gap: ${({ theme }) => theme.margin.sm};\n`\n\nconst StyledBookmarkIcon = styled(BookmarkBorder)`\n  height: 16px;\n  vertical-align: middle;\n`\n\nconst PinnedAppsTutorial = (): React.ReactElement => (\n  <NoAppsFoundTextContainer>\n    <Img alt=\"Info\" src={InfoIcon} />\n    <Text size=\"xl\">\n      Simply hover over an app and click on the\n      <StyledBookmarkIcon />\n      to bookmark the app here for convenient access\n    </Text>\n  </NoAppsFoundTextContainer>\n)\n\nexport { PinnedAppsTutorial }\n","import {\n  Button,\n  Card,\n  IconText,\n  Loader,\n  Menu,\n  Text,\n  Breadcrumb,\n  BreadcrumbElement,\n} from '@gnosis.pm/safe-react-components'\nimport { useState } from 'react'\nimport styled, { css } from 'styled-components'\nimport { motion, AnimatePresence } from 'framer-motion'\n\nimport Collapse from 'src/components/Collapse'\nimport Col from 'src/components/layout/Col'\nimport { Modal } from 'src/components/Modal'\nimport { useStateHandler } from 'src/logic/hooks/useStateHandler'\nimport AddAppIcon from 'src/routes/safe/components/Apps/assets/addApp.svg'\nimport { SearchInputCard } from './SearchInputCard'\nimport { NoAppsFound } from './NoAppsFound'\nimport { SafeApp } from '../types'\nimport AddAppForm from './AddAppForm'\nimport { useAppList } from '../hooks/appList/useAppList'\nimport { useAppsSearch } from '../hooks/useAppsSearch'\nimport SafeAppCard from 'src/routes/safe/components/Apps/components/SafeAppCard/SafeAppCard'\nimport { PinnedAppsTutorial } from './PinnedAppsTutorial'\nimport useSafeAddress from 'src/logic/currentSession/hooks/useSafeAddress'\n\nexport const PINNED_APPS_LIST_TEST_ID = 'safe_apps__pinned-apps-container'\nexport const ALL_APPS_LIST_TEST_ID = 'safe_apps__all-apps-container'\n\nconst Wrapper = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`\n\nconst centerCSS = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst LoadingContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  ${centerCSS};\n`\n\nconst CardsWrapper = styled(motion.div)`\n  width: 100%;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(243px, 1fr));\n  column-gap: 20px;\n  row-gap: 20px;\n  justify-content: space-evenly;\n`\n\nconst ContentWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  align-items: center;\n`\n\nconst SectionHeading = styled(Text)`\n  width: 100%;\n  margin: ${({ theme }) => `${theme.margin.xl} 0 ${theme.margin.md} 0`};\n`\n\nconst CenterIconText = styled(IconText)`\n  justify-content: center;\n  margin: 16px 55px 20px 0;\n`\n\nconst AddCustomSafeAppCard = styled(Card)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 190px;\n  padding: 0;\n  flex-direction: column;\n  box-shadow: none;\n`\n\nconst AddCustomAppLogo = styled.img`\n  height: 90px;\n  margin-bottom: 4px;\n`\n\ntype AppListProps = {\n  onRemoveApp: (appUrl: string) => void\n}\n\nconst AppsList = ({ onRemoveApp }: AppListProps): React.ReactElement => {\n  const { safeAddress } = useSafeAddress()\n  const [appSearch, setAppSearch] = useState('')\n  const { allApps, appList, removeApp, isLoading, pinnedSafeApps, togglePin, customApps, addCustomApp } = useAppList()\n  const apps = useAppsSearch(appList, appSearch)\n  const [appToRemove, setAppToRemove] = useState<SafeApp | null>(null)\n  const { open: isAddAppModalOpen, toggle: openAddAppModal, clickAway: closeAddAppModal } = useStateHandler()\n  const noAppsFound = apps.length === 0 && appSearch\n  const showCustomApps = !!customApps.length && !appSearch\n  const showPinnedApps = !appSearch\n\n  if (isLoading || !safeAddress) {\n    return (\n      <LoadingContainer>\n        <Loader size=\"md\" />\n      </LoadingContainer>\n    )\n  }\n\n  return (\n    <Wrapper>\n      <Menu>\n        <Col start=\"sm\" xs={12}>\n          <Breadcrumb>\n            <BreadcrumbElement iconType=\"apps\" text=\"Apps\" />\n          </Breadcrumb>\n        </Col>\n      </Menu>\n      <ContentWrapper>\n        <SearchInputCard value={appSearch} onValueChange={(value) => setAppSearch(value.replace(/\\s{2,}/g, ' '))} />\n\n        {showPinnedApps && (\n          <Collapse\n            title={\n              <Text color=\"placeHolder\" strong size=\"md\">\n                BOOKMARKED APPS\n              </Text>\n            }\n            defaultExpanded\n          >\n            {pinnedSafeApps.length === 0 && <PinnedAppsTutorial />}\n            <AnimatePresence>\n              <CardsWrapper data-testid={PINNED_APPS_LIST_TEST_ID}>\n                {pinnedSafeApps.map((pinnedSafeApp) => (\n                  <SafeAppCard\n                    key={pinnedSafeApp.id}\n                    safeApp={pinnedSafeApp}\n                    togglePin={togglePin}\n                    size=\"md\"\n                    isPinned\n                  />\n                ))}\n              </CardsWrapper>\n            </AnimatePresence>\n          </Collapse>\n        )}\n\n        {showCustomApps && (\n          <Collapse\n            title={\n              <Text color=\"placeHolder\" strong size=\"md\">\n                CUSTOM APPS\n              </Text>\n            }\n            defaultExpanded\n          >\n            <AnimatePresence>\n              <CardsWrapper>\n                {customApps.map((customSafeApp) => (\n                  <SafeAppCard\n                    key={customSafeApp.id}\n                    safeApp={customSafeApp}\n                    togglePin={togglePin}\n                    onRemove={setAppToRemove}\n                    isCustomSafeApp\n                    size=\"md\"\n                  />\n                ))}\n              </CardsWrapper>\n            </AnimatePresence>\n          </Collapse>\n        )}\n\n        <SectionHeading color=\"placeHolder\" strong size=\"md\">\n          {appSearch ? 'SEARCH RESULTS' : 'ALL APPS'}\n        </SectionHeading>\n        {noAppsFound && <NoAppsFound query={appSearch} onWalletConnectSearch={() => setAppSearch('WalletConnect')} />}\n        <AnimatePresence>\n          <CardsWrapper data-testid={ALL_APPS_LIST_TEST_ID}>\n            {!appSearch && (\n              <AddCustomSafeAppCard>\n                <AddCustomAppLogo src={AddAppIcon} alt=\"Add Custom Safe App logo\" />\n                <Button size=\"md\" color=\"primary\" variant=\"contained\" onClick={() => openAddAppModal()}>\n                  Add custom app\n                </Button>\n              </AddCustomSafeAppCard>\n            )}\n\n            {apps.map((safeApp) => (\n              <SafeAppCard\n                key={safeApp.id}\n                safeApp={safeApp}\n                togglePin={togglePin}\n                isPinned={pinnedSafeApps.some((pinnedSafeApp) => pinnedSafeApp.id === safeApp.id)}\n                size=\"md\"\n              />\n            ))}\n          </CardsWrapper>\n        </AnimatePresence>\n      </ContentWrapper>\n\n      <CenterIconText\n        color=\"secondary\"\n        iconSize=\"sm\"\n        iconType=\"info\"\n        text=\"These are third-party apps, which means they are not owned, controlled, maintained or audited by Safe. Interacting with the apps is at your own risk. Any communication within the Apps is for informational purposes only and must not be construed as investment advice to engage in any transaction.\"\n        textSize=\"sm\"\n      />\n\n      {isAddAppModalOpen && (\n        <Modal title=\"Add app\" description=\"Add a custom app to the list of apps\" handleClose={closeAddAppModal}>\n          <Modal.Header onClose={closeAddAppModal}>\n            <Modal.Header.Title>Add custom app</Modal.Header.Title>\n          </Modal.Header>\n          <AddAppForm closeModal={closeAddAppModal} appList={allApps} onAddApp={addCustomApp} />\n        </Modal>\n      )}\n\n      {appToRemove && (\n        <Modal title=\"Remove app\" description=\"Confirm for the app removal\" handleClose={() => setAppToRemove(null)}>\n          <Modal.Header onClose={() => setAppToRemove(null)}>\n            <Modal.Header.Title>Remove app</Modal.Header.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Text size=\"xl\">\n              This action will remove{' '}\n              <Text size=\"xl\" strong as=\"span\">\n                {appToRemove.name}\n              </Text>{' '}\n              from the interface\n            </Text>\n          </Modal.Body>\n          <Modal.Footer>\n            <Modal.Footer.Buttons\n              cancelButtonProps={{ testId: 'cancel-btn', onClick: () => setAppToRemove(null) }}\n              confirmButtonProps={{\n                testId: 'confirm-btn',\n                color: 'error',\n                onClick: () => {\n                  const url = appToRemove.url\n\n                  onRemoveApp(url)\n                  removeApp(appToRemove.id, url)\n                  setAppToRemove(null)\n                },\n                text: 'Remove',\n              }}\n            />\n          </Modal.Footer>\n        </Modal>\n      )}\n    </Wrapper>\n  )\n}\n\nexport default AppsList\n","import { useMemo } from 'react'\nimport Fuse from 'fuse.js'\nimport { SafeApp } from 'src/routes/safe/components/Apps/types'\n\nconst useAppsSearch = (apps: SafeApp[], searchText: string): SafeApp[] => {\n  const fuse = useMemo(\n    () =>\n      new Fuse(apps, {\n        keys: ['name', 'description'],\n        // https://fusejs.io/api/options.html#threshold\n        // Very naive explanation: threshold represents how accurate the search results should be. The default is 0.6\n        // I tested it and found it to make the search results more accurate when the threshold is 0.2\n        // 0 - 1, where 0 is the exact match and 1 matches anything\n        threshold: 0.2,\n        findAllMatches: true,\n      }),\n    [apps],\n  )\n\n  const results = useMemo(\n    () => (searchText ? fuse.search(searchText).map((result) => result.item) : apps),\n    [fuse, apps, searchText],\n  )\n\n  return results\n}\n\nexport { useAppsSearch }\n","import React, { useState, useEffect, useMemo } from 'react'\nimport styled from 'styled-components'\nimport { Box } from '@material-ui/core'\nimport { Button } from '@gnosis.pm/safe-react-components'\n\ntype SliderProps = {\n  onSlideChange: (slideIndex: number) => void\n  initialStep?: number\n}\n\nconst SLIDER_TIMEOUT = 500\n\nconst Slider: React.FC<SliderProps> = ({ onSlideChange, children, initialStep }) => {\n  const allSlides = useMemo(() => React.Children.toArray(children).filter(Boolean) as React.ReactElement[], [children])\n\n  const [activeStep, setActiveStep] = useState(initialStep || 0)\n  const [disabledBtn, setDisabledBtn] = useState(false)\n\n  useEffect(() => {\n    let id: ReturnType<typeof setTimeout>\n\n    if (disabledBtn) {\n      id = setTimeout(() => {\n        setDisabledBtn(false)\n      }, SLIDER_TIMEOUT)\n    }\n\n    return () => {\n      if (id) clearTimeout(id)\n    }\n  }, [disabledBtn])\n\n  const nextSlide = () => {\n    if (disabledBtn) return\n\n    const nextStep = activeStep + 1\n\n    onSlideChange(nextStep)\n    setActiveStep(nextStep)\n    setDisabledBtn(true)\n  }\n\n  const prevSlide = () => {\n    if (disabledBtn) return\n\n    const prevStep = activeStep - 1\n\n    onSlideChange(prevStep)\n    setActiveStep(prevStep)\n    setDisabledBtn(true)\n  }\n\n  const isFirstStep = activeStep === 0\n\n  return (\n    <>\n      <StyledContainer className=\"container\">\n        <StyledInner className=\"inner\" activeStep={activeStep}>\n          {allSlides.map((slide, index) => (\n            <SliderItem key={index}>{slide}</SliderItem>\n          ))}\n        </StyledInner>\n      </StyledContainer>\n      <Box display=\"flex\" justifyContent=\"center\" width=\"100%\">\n        <Button color=\"primary\" size=\"md\" variant=\"bordered\" fullWidth onClick={prevSlide}>\n          {isFirstStep ? 'Cancel' : 'Back'}\n        </Button>\n\n        <Button\n          color=\"primary\"\n          size=\"md\"\n          fullWidth\n          onClick={nextSlide}\n          style={{\n            marginLeft: 10,\n          }}\n        >\n          Continue\n        </Button>\n      </Box>\n    </>\n  )\n}\n\nconst StyledContainer = styled.div`\n  position: relative;\n  margin: 0 auto;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`\n\nconst StyledInner = styled.div<{ activeStep: number }>`\n  position: relative;\n  display: flex;\n  min-width: 100%;\n  min-height: 100%;\n  transform: translateX(0);\n  height: 426px;\n\n  transition: transform 0.5s ease;\n  transform: translateX(-${({ activeStep }) => activeStep * 100}%);\n`\n\nconst SliderItem = styled.div`\n  min-width: 100%;\n  min-height: 100%;\n\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n`\n\nexport default Slider\n","import { Text, Link } from '@gnosis.pm/safe-react-components'\nimport styled from 'styled-components'\n\nimport {\n  StyledSecurityTitle,\n  StyledTitle,\n} from 'src/routes/safe/components/Apps/components/SecurityFeedbackModal/styles'\n\nconst LegalDisclaimer = (): JSX.Element => (\n  <StyledContainer>\n    <StyledSecurityTitle size=\"lg\">Before starting to use Safe dApps...</StyledSecurityTitle>\n    <StyledTitle size=\"sm\" bold centered>\n      Disclaimer\n    </StyledTitle>\n    <StyledText size=\"xl\">\n      You are now accessing third-party apps, which we do not own, control, maintain or audit. We are not liable for any\n      loss you may suffer in connection with interacting with the apps, which is at your own risk.\n    </StyledText>\n    <br />\n    <br />\n    <StyledText size=\"xl\">\n      You must read our Terms, which contain more detailed provisions binding on you relating to the apps.\n    </StyledText>\n    <br />\n    <br />\n    <StyledText size=\"xl\">\n      I have read and understood the{' '}\n      <StyledLink href=\"https://gnosis-safe.io/terms\" size=\"xl\" rel=\"noopener noreferrer\" target=\"_blank\">\n        Terms\n      </StyledLink>{' '}\n      and this Disclaimer, and agree to be bound by them.\n    </StyledText>\n  </StyledContainer>\n)\n\nconst StyledContainer = styled.div`\n  p,\n  h4 {\n    line-height: 24px;\n  }\n`\n\nconst StyledLink = styled(Link)`\n  text-decoration: none;\n`\n\nconst StyledText = styled(Text)`\n  text-align: justify;\n`\n\nexport default LegalDisclaimer\n","import { Box } from '@material-ui/core'\nimport styled from 'styled-components'\nimport { Text, Dot, Icon, Title } from '@gnosis.pm/safe-react-components'\n\nimport { SecurityFeedbackPractice } from 'src/routes/safe/components/Apps/types'\n\ntype SecurityFeedbackListProps = {\n  practices: SecurityFeedbackPractice[]\n  appUrl: string\n}\n\nconst SecurityFeedbackList = ({ practices }: SecurityFeedbackListProps): React.ReactElement => {\n  return (\n    <>\n      <StyledIcon size=\"md\" type=\"privacyPolicy\" color=\"primary\" />\n      <StyledTitle size=\"xs\">Best security practices when interacting with Safe Apps</StyledTitle>\n\n      {practices.map((practice, index) => (\n        <Box key={index} display=\"flex\" marginBottom={2} alignItems=\"flex-start\">\n          <StyledDot color=\"primary\">\n            <StyledDotText size=\"sm\">{index + 1}</StyledDotText>\n          </StyledDot>\n          <Box flexDirection=\"column\">\n            <Text size=\"xl\">{practice.title}</Text>\n            {practice.subtitle && <Text size=\"xl\">{practice.subtitle}</Text>}\n          </Box>\n        </Box>\n      ))}\n    </>\n  )\n}\n\nconst StyledIcon = styled(Icon)`\n  margin-top: 10px;\n`\n\nconst StyledTitle = styled(Title)`\n  font-weight: bold;\n  text-align: center;\n`\n\nconst StyledDot = styled(Dot)`\n  min-width: 19px;\n  width: 19px;\n  height: 19px;\n  margin-right: 19px;\n  background: ${({ theme }) => theme.colors.background};\n  color: ${({ theme }) => theme.colors.secondaryHover};\n`\n\nconst StyledDotText = styled(Text)`\n  position: absolute;\n  font-size: 11px;\n`\n\nexport default SecurityFeedbackList\n","export const SECURITY_PRACTICES = [\n  {\n    id: '1',\n    title: 'Always load Safe Apps from trusted sources.',\n    imageSrc: './safe-apps-security-practices/1.png',\n  },\n  {\n    id: '2',\n    title: 'Check the Safe App link you are trying to use.',\n    subtitle: 'Do you know the domain and trust it?',\n  },\n  {\n    id: '3',\n    title: 'Always check transaction information while creating it, before proposing it to the Safe.',\n    imageSrc: './safe-apps-security-practices/2.png',\n  },\n  {\n    id: '4',\n    title: 'Do a second check on transaction data before signing in the queue.',\n    imageSrc: './safe-apps-security-practices/3.png',\n  },\n]\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Icon, Title } from '@gnosis.pm/safe-react-components'\n\nimport { StyledSecurityTitle } from 'src/routes/safe/components/Apps/components/SecurityFeedbackModal/styles'\nimport { SecurityFeedbackPractice } from 'src/routes/safe/components/Apps/types'\n\ntype SecurityFeedbackContentProps = Omit<SecurityFeedbackPractice, 'id'>\n\nconst SecurityFeedbackContent: React.FC<SecurityFeedbackContentProps> = ({\n  title,\n  subtitle,\n  imageSrc,\n  children,\n}): React.ReactElement => {\n  return (\n    <>\n      <Icon size=\"md\" type=\"privacyPolicy\" />\n      <StyledSecurityTitle size=\"lg\">\n        Secure your activity with Safe dApps by following simple rules\n      </StyledSecurityTitle>\n\n      {imageSrc ? (\n        <StyledImageContainer>\n          <StyledImage src={imageSrc} alt={title} />\n        </StyledImageContainer>\n      ) : (\n        <StyledContentContainer>{children}</StyledContentContainer>\n      )}\n\n      <StyledTextContainer>\n        <StyledTitle size=\"xs\">{title}</StyledTitle>\n        {subtitle && <StyledTitle size=\"xs\">{subtitle}</StyledTitle>}\n      </StyledTextContainer>\n    </>\n  )\n}\n\nconst StyledContentContainer = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 160px;\n`\n\nconst StyledImageContainer = styled(StyledContentContainer)`\n  height: 190px;\n  padding: 0 30px;\n`\n\nconst StyledTextContainer = styled.div`\n  margin: 40px 20px 64px 20px;\n`\n\nconst StyledTitle = styled(Title)`\n  text-align: center;\n`\n\nconst StyledImage = styled.img`\n  max-width: 100%;\n  max-height: 100%;\n  margin-top: 15px;\n`\n\nexport default SecurityFeedbackContent\n","import React from 'react'\nimport { Icon, Text } from '@gnosis.pm/safe-react-components'\n\nimport { AllowedFeatures, AllowedFeatureSelection } from 'src/routes/safe/components/Apps/types'\nimport { StyledSecurityTitle } from 'src/routes/safe/components/Apps/components/SecurityFeedbackModal/styles'\nimport PermissionsCheckbox from 'src/routes/safe/components/Apps/components/PermissionCheckbox'\nimport { BROWSER_PERMISSIONS_TEXTS } from 'src/routes/safe/components/Apps/hooks/permissions'\nimport { Box } from '@material-ui/core'\n\ntype SecurityFeedbackAllowedFeaturesProps = {\n  features: AllowedFeatureSelection[]\n  onFeatureSelectionChange: (feature: AllowedFeatures, checked: boolean) => void\n}\n\nconst SecurityFeedbackAllowedFeatures: React.FC<SecurityFeedbackAllowedFeaturesProps> = ({\n  features,\n  onFeatureSelectionChange,\n}): React.ReactElement => {\n  return (\n    <>\n      <Icon size=\"md\" type=\"privacyPolicy\" />\n      <StyledSecurityTitle size=\"lg\">Manage the features Safe App can use</StyledSecurityTitle>\n      <Box mx={1} my={3}>\n        <Text size=\"xl\">This app is requesting permission to use:</Text>\n        <br />\n        <Box display=\"flex\" flexDirection=\"column\" ml={2}>\n          {features.map(({ feature, checked }, index) => (\n            <PermissionsCheckbox\n              key={index}\n              name=\"checkbox\"\n              checked={checked}\n              onChange={(_, checked) => onFeatureSelectionChange(feature, checked)}\n              label={BROWSER_PERMISSIONS_TEXTS[feature].displayName}\n            />\n          ))}\n        </Box>\n      </Box>\n    </>\n  )\n}\n\nexport default SecurityFeedbackAllowedFeatures\n","import { memo, useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport Grid from '@material-ui/core/Grid'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport { alpha } from '@material-ui/core/styles'\nimport Slider from './Slider'\nimport LegalDisclaimer from './LegalDisclaimer'\nimport SecurityFeedbackList from './SecurityFeedbackList'\nimport UnknownAppWarning from './UnknownAppWarning'\nimport { SECURITY_PRACTICES } from './constants'\nimport SecurityFeedbackContent from './SecurityFeedbackContent'\nimport {\n  AllowedFeatures,\n  AllowedFeatureSelection,\n  PermissionStatus,\n  SecurityFeedbackPractice,\n} from 'src/routes/safe/components/Apps/types'\nimport SecurityFeedbackDomain from './SecurityFeedbackDomain'\nimport SecurityFeedbackAllowedFeatures from './SecurityFeedbackAllowedFeatures'\nimport { BrowserPermission } from '../../hooks/permissions/useBrowserPermissions'\n\ninterface SecurityFeedbackModalProps {\n  onCancel: () => void\n  onConfirm: (hideWarning: boolean, browserPermisisons: BrowserPermission[]) => void\n  appUrl: string\n  features: AllowedFeatures[]\n  isConsentAccepted?: boolean\n  isSafeAppInDefaultList: boolean\n  isFirstTimeAccessingApp: boolean\n  isExtendedListReviewed: boolean\n  isPermissionsReviewCompleted: boolean\n}\n\nconst SecurityFeedbackModal = ({\n  onCancel,\n  onConfirm,\n  appUrl,\n  features,\n  isConsentAccepted,\n  isSafeAppInDefaultList,\n  isFirstTimeAccessingApp,\n  isExtendedListReviewed,\n  isPermissionsReviewCompleted,\n}: SecurityFeedbackModalProps): JSX.Element => {\n  const [hideWarning, setHideWarning] = useState(false)\n  const [selectedFeatures, setSelectedFeatures] = useState<AllowedFeatureSelection[]>(\n    features.map((feature) => {\n      return {\n        feature,\n        checked: true,\n      }\n    }),\n  )\n  const [currentSlide, setCurrentSlide] = useState(0)\n\n  const totalSlides = useMemo(() => {\n    let totalSlides = 0\n\n    if (!isConsentAccepted) {\n      totalSlides += 1\n    }\n\n    if (isFirstTimeAccessingApp && isExtendedListReviewed) {\n      totalSlides += 1\n    }\n\n    if (isFirstTimeAccessingApp && !isExtendedListReviewed) {\n      totalSlides += SECURITY_PRACTICES.length\n    }\n\n    if (!isSafeAppInDefaultList && isFirstTimeAccessingApp) {\n      totalSlides += 1\n    }\n\n    if (!isPermissionsReviewCompleted) {\n      totalSlides += 1\n    }\n\n    return totalSlides\n  }, [\n    isConsentAccepted,\n    isExtendedListReviewed,\n    isFirstTimeAccessingApp,\n    isSafeAppInDefaultList,\n    isPermissionsReviewCompleted,\n  ])\n\n  const handleSlideChange = (newStep: number) => {\n    const isFirstStep = newStep === -1\n    const isLastStep = newStep === totalSlides\n\n    if (isFirstStep) {\n      onCancel()\n    }\n\n    if (isLastStep) {\n      onConfirm(\n        hideWarning,\n        selectedFeatures.map(({ feature, checked }) => {\n          return {\n            feature,\n            status: checked ? PermissionStatus.GRANTED : PermissionStatus.DENIED,\n          }\n        }),\n      )\n    }\n\n    setCurrentSlide(newStep)\n  }\n\n  const progressValue = useMemo(() => {\n    return ((currentSlide + 1) * 100) / totalSlides\n  }, [currentSlide, totalSlides])\n\n  const isLastSlide = useMemo(() => {\n    return currentSlide === totalSlides - 1\n  }, [currentSlide, totalSlides])\n\n  const shouldShowUnknownAppWarning = useMemo(\n    () => !isSafeAppInDefaultList && isFirstTimeAccessingApp,\n    [isFirstTimeAccessingApp, isSafeAppInDefaultList],\n  )\n\n  const handleFeatureSelectionChange = (feature: AllowedFeatures, checked: boolean) => {\n    setSelectedFeatures(\n      selectedFeatures.map((feat) => {\n        if (feat.feature === feature) {\n          return {\n            feature,\n            checked,\n          }\n        }\n        return feat\n      }),\n    )\n  }\n\n  return (\n    <StyledContainer>\n      <StyledWrapper>\n        <StyledLinearProgress\n          variant=\"determinate\"\n          value={progressValue}\n          $isWarningStep={isLastSlide && shouldShowUnknownAppWarning}\n        />\n        <StyledGrid container justifyContent=\"center\" alignItems=\"center\" direction=\"column\">\n          <Slider onSlideChange={handleSlideChange}>\n            {!isConsentAccepted && <LegalDisclaimer />}\n            {isFirstTimeAccessingApp && isExtendedListReviewed && (\n              <SecurityFeedbackList practices={SECURITY_PRACTICES} appUrl={appUrl} />\n            )}\n            {isFirstTimeAccessingApp &&\n              !isExtendedListReviewed &&\n              SECURITY_PRACTICES.map((practice: SecurityFeedbackPractice) => {\n                return practice.imageSrc ? (\n                  <SecurityFeedbackContent key={practice.id} {...practice} />\n                ) : (\n                  <SecurityFeedbackContent key={practice.id} {...practice}>\n                    <SecurityFeedbackDomain url={appUrl} />\n                  </SecurityFeedbackContent>\n                )\n              })}\n            {!isPermissionsReviewCompleted && (\n              <SecurityFeedbackAllowedFeatures\n                features={selectedFeatures}\n                onFeatureSelectionChange={handleFeatureSelectionChange}\n              />\n            )}\n            {shouldShowUnknownAppWarning && <UnknownAppWarning url={appUrl} onHideWarning={setHideWarning} />}\n          </Slider>\n        </StyledGrid>\n      </StyledWrapper>\n    </StyledContainer>\n  )\n}\n\nconst StyledContainer = styled.div`\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n`\n\nconst StyledWrapper = styled.div`\n  width: 450px;\n  background-color: ${({ theme }) => theme.colors.white};\n  border-radius: 8px;\n  box-shadow: 1px 2px 10px 0 ${({ theme }) => alpha(theme.colors.shadow.color, 0.18)};\n`\n\nconst StyledGrid = styled(Grid)`\n  text-align: center;\n  padding: 24px;\n`\n\nconst StyledLinearProgress = styled(LinearProgress)<{ $isWarningStep: boolean }>`\n  height: 6px;\n  background-color: #fff;\n  border-radius: 8px 8px 0 0;\n  .MuiLinearProgress-bar {\n    background-color: ${({ theme, $isWarningStep }) => ($isWarningStep ? '#e8663d' : theme.colors.primary)};\n    border-radius: 8px;\n  }\n`\n\nexport default memo(SecurityFeedbackModal)\n","import React, { ReactNode, ErrorInfo } from 'react'\n\ntype SafeAppsErrorBoundaryProps = {\n  children?: ReactNode\n  render: () => ReactNode\n}\n\ntype SafeAppsErrorBoundaryState = {\n  hasError: boolean\n  error?: Error\n}\n\nclass SafeAppsErrorBoundary extends React.Component<SafeAppsErrorBoundaryProps, SafeAppsErrorBoundaryState> {\n  public state: SafeAppsErrorBoundaryState = {\n    hasError: false,\n  }\n\n  constructor(props: SafeAppsErrorBoundaryProps) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    console.error('Uncaught error:', error, errorInfo)\n  }\n\n  public static getDerivedStateFromError(error: Error): SafeAppsErrorBoundaryState {\n    return { hasError: true, error }\n  }\n\n  public render(): React.ReactNode {\n    if (this.state.hasError) {\n      return this.props.render()\n    }\n\n    return this.props.children\n  }\n}\n\nexport default SafeAppsErrorBoundary\n","import { useSelector } from 'react-redux'\nimport { useHistory } from 'react-router-dom'\nimport { currentSession } from 'src/logic/currentSession/store/selectors'\nimport styled from 'styled-components'\nimport { Text, Link, Icon, FixedIcon, Title } from '@gnosis.pm/safe-react-components'\nimport { generateSafeRoute, SAFE_ROUTES } from 'src/routes/routes'\n\nconst SafeAppsLoadError = (): React.ReactElement => {\n  const history = useHistory()\n  const { currentShortName, currentSafeAddress } = useSelector(currentSession)\n  const handleGoBack = () => {\n    history.push(\n      generateSafeRoute(SAFE_ROUTES.APPS, {\n        safeAddress: currentSafeAddress,\n        shortName: currentShortName,\n      }),\n    )\n  }\n\n  return (\n    <Wrapper>\n      <Content>\n        <Title size=\"md\">Safe App could not be loaded.</Title>\n        <FixedIcon type=\"networkError\" />\n\n        <div>\n          <Text size=\"xl\" as=\"span\">\n            In case the problem persists, please reach out to us via{' '}\n          </Text>\n          <LinkWrapper>\n            <a target=\"_blank\" href=\"https://chat.gnosis-safe.io\" rel=\"noopener noreferrer\">\n              <Text color=\"primary\" size=\"lg\" as=\"span\">\n                Discord\n              </Text>\n            </a>\n            <Icon type=\"externalLink\" color=\"primary\" size=\"sm\" />\n          </LinkWrapper>\n        </div>\n\n        <Link size=\"lg\" color=\"primary\" onClick={handleGoBack}>\n          Go back to the Safe Apps list\n        </Link>\n      </Content>\n    </Wrapper>\n  )\n}\n\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`\n\nconst Content = styled.div`\n  width: 400px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n\n  > * {\n    margin-top: 10px;\n  }\n`\n\nconst LinkWrapper = styled.div`\n  display: inline-flex;\n  margin-bottom: 10px;\n\n  > :first-of-type {\n    margin-right: 5px;\n  }\n`\n\nexport default SafeAppsLoadError\n","import { useState, useEffect, useCallback, useMemo, useRef } from 'react'\nimport { loadFromStorage, saveToStorage } from 'src/utils/storage'\nimport { BrowserPermission } from './permissions/useBrowserPermissions'\nimport { AllowedFeatures, PermissionStatus, SafeApp } from '../types'\n\nconst APPS_SECURITY_FEEDBACK_MODAL = 'APPS_SECURITY_FEEDBACK_MODAL'\n\ntype SecurityFeedbackModalStorage = {\n  appsReviewed: string[]\n  extendedListReviewed: boolean\n  customAppsReviewed: string[]\n  consentAccepted: boolean\n}\n\ntype useSecurityFeedbackModal = {\n  url: string\n  safeApp?: SafeApp\n  safeAppManifest?: SafeApp\n  addPermissions: (origin: string, permissions: BrowserPermission[]) => void\n  getPermissions: (origin: string) => BrowserPermission[]\n}\n\nconst useSecurityFeedbackModal = ({\n  url,\n  safeApp,\n  safeAppManifest,\n  addPermissions,\n  getPermissions,\n}: useSecurityFeedbackModal): {\n  isModalVisible: boolean\n  isSafeAppInDefaultList: boolean\n  isFirstTimeAccessingApp: boolean\n  isConsentAccepted: boolean\n  isExtendedListReviewed: boolean\n  isPermissionsReviewCompleted: boolean\n  onComplete: (shouldHide: boolean, permissions: BrowserPermission[]) => void\n  onRemoveCustomApp: (appUrl: string) => void\n} => {\n  const didMount = useRef(false)\n\n  const [appsReviewed, setAppsReviewed] = useState<string[]>([])\n  const [extendedListReviewed, setExtendedListReviewed] = useState(false)\n  const [customAppsReviewed, setCustomAppsReviewed] = useState<string[]>([])\n  const [consentAccepted, setConsentAccepted] = useState<boolean>(false)\n  const [isDisclaimerReadingCompleted, setIsDisclaimerReadingCompleted] = useState(false)\n\n  useEffect(() => {\n    const securityStepsStatus: SecurityFeedbackModalStorage = loadFromStorage(APPS_SECURITY_FEEDBACK_MODAL) || {\n      appsReviewed: [],\n      extendedListReviewed: false,\n      customAppsReviewed: [],\n      consentAccepted: false,\n    }\n\n    if (securityStepsStatus) {\n      setAppsReviewed(securityStepsStatus.appsReviewed)\n      setExtendedListReviewed(securityStepsStatus.extendedListReviewed)\n      setCustomAppsReviewed(securityStepsStatus.customAppsReviewed)\n      setConsentAccepted(securityStepsStatus.consentAccepted)\n    }\n  }, [])\n\n  useEffect(() => {\n    if (!url) {\n      setIsDisclaimerReadingCompleted(false)\n    }\n  }, [url])\n\n  useEffect(() => {\n    if (!didMount.current) {\n      didMount.current = true\n      return\n    }\n\n    saveToStorage(APPS_SECURITY_FEEDBACK_MODAL, {\n      appsReviewed,\n      extendedListReviewed,\n      customAppsReviewed,\n      consentAccepted,\n    })\n  }, [appsReviewed, consentAccepted, customAppsReviewed, extendedListReviewed])\n\n  const isSafeAppInDefaultList = useMemo(() => {\n    if (!url) return false\n\n    return !!safeApp\n  }, [safeApp, url])\n\n  const isFirstTimeAccessingApp = useMemo(() => {\n    if (!url) return true\n\n    const safeAppId = safeApp?.id\n\n    return safeAppId ? !appsReviewed?.includes(safeAppId) : !customAppsReviewed?.includes(url)\n  }, [appsReviewed, customAppsReviewed, safeApp, url])\n\n  const isPermissionsReviewCompleted = useMemo(() => {\n    if (!url) return false\n\n    const safeAppRequiredFeatures = safeAppManifest?.safeAppsPermissions || []\n    const featureHasBeenGrantedOrDenied = (feature: AllowedFeatures) =>\n      getPermissions(url).some((permission: BrowserPermission) => {\n        return permission.feature === feature && permission.status !== PermissionStatus.PROMPT\n      })\n\n    // If the app add a new feature in the manifest we need to detect it and show the modal again\n    return !!safeAppRequiredFeatures.every(featureHasBeenGrantedOrDenied)\n  }, [getPermissions, safeAppManifest, url])\n\n  const isModalVisible = useMemo(() => {\n    const isComponentReady = didMount.current\n    const shouldShowLegalDisclaimer = !consentAccepted\n    const shouldShowAllowedFeatures = !isPermissionsReviewCompleted\n    const shouldShowSecurityPractices = isSafeAppInDefaultList && isFirstTimeAccessingApp\n    const shouldShowUnknownAppWarning =\n      !isSafeAppInDefaultList && isFirstTimeAccessingApp && !isDisclaimerReadingCompleted\n\n    return (\n      isComponentReady &&\n      (shouldShowLegalDisclaimer ||\n        shouldShowSecurityPractices ||\n        shouldShowUnknownAppWarning ||\n        shouldShowAllowedFeatures)\n    )\n  }, [\n    consentAccepted,\n    isPermissionsReviewCompleted,\n    isSafeAppInDefaultList,\n    isFirstTimeAccessingApp,\n    isDisclaimerReadingCompleted,\n  ])\n\n  const onComplete = useCallback(\n    (shouldHide: boolean, browserPermissions: BrowserPermission[]) => {\n      setConsentAccepted(true)\n\n      const safeAppId = safeApp?.id\n\n      if (safeAppId && !appsReviewed.includes(safeAppId)) {\n        const reviewedApps = [...appsReviewed, safeAppId]\n\n        setAppsReviewed(reviewedApps)\n      } else {\n        if (shouldHide && !customAppsReviewed.includes(url)) {\n          const reviewedApps = [...customAppsReviewed, url]\n\n          setCustomAppsReviewed(reviewedApps)\n        }\n      }\n\n      if (!extendedListReviewed) {\n        setExtendedListReviewed(true)\n      }\n\n      if (!isPermissionsReviewCompleted) {\n        addPermissions(url, browserPermissions)\n      }\n\n      setIsDisclaimerReadingCompleted(true)\n    },\n    [\n      addPermissions,\n      appsReviewed,\n      customAppsReviewed,\n      extendedListReviewed,\n      isPermissionsReviewCompleted,\n      safeApp,\n      url,\n    ],\n  )\n\n  const onRemoveCustomApp = useCallback(\n    (appUrl: string): void => {\n      const reviewedApps = customAppsReviewed.filter((url) => url !== appUrl)\n      setCustomAppsReviewed(reviewedApps)\n    },\n    [customAppsReviewed],\n  )\n\n  return {\n    isModalVisible,\n    isSafeAppInDefaultList,\n    isFirstTimeAccessingApp,\n    isPermissionsReviewCompleted,\n    isConsentAccepted: consentAccepted,\n    isExtendedListReviewed: extendedListReviewed,\n    onComplete,\n    onRemoveCustomApp,\n  }\n}\n\nexport { useSecurityFeedbackModal }\n","import { useCallback } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { useSafeAppUrl } from 'src/logic/hooks/useSafeAppUrl'\nimport AppFrame from 'src/routes/safe/components/Apps/components/AppFrame'\nimport AppsList from 'src/routes/safe/components/Apps/components/AppsList'\nimport SecurityFeedbackModal from 'src/routes/safe/components/Apps/components/SecurityFeedbackModal'\nimport SafeAppsErrorBoundary from 'src/routes/safe/components/Apps/components/SafeAppsErrorBoundary'\nimport SafeAppsLoadError from 'src/routes/safe/components/Apps/components/SafeAppsLoadError'\nimport { useSecurityFeedbackModal } from 'src/routes/safe/components/Apps/hooks/useSecurityFeedbackModal'\nimport { useSafeAppFromManifest } from 'src/routes/safe/components/Apps/hooks/useSafeAppFromManifest'\nimport { useAppList } from 'src/routes/safe/components/Apps/hooks/appList/useAppList'\nimport { useBrowserPermissions } from 'src/routes/safe/components/Apps/hooks/permissions'\n\nconst Apps = (): React.ReactElement => {\n  const history = useHistory()\n  const { getAppUrl } = useSafeAppUrl()\n  const url = getAppUrl()\n  const { addPermissions, getPermissions, getAllowedFeaturesList } = useBrowserPermissions()\n  const { isLoading: isSafeAppListLoading, getSafeApp } = useAppList()\n  const { isLoading: isSafeAppManifestLoading, safeApp: safeAppManifest } = useSafeAppFromManifest(url)\n\n  const {\n    isModalVisible,\n    isSafeAppInDefaultList,\n    isFirstTimeAccessingApp,\n    isConsentAccepted,\n    isPermissionsReviewCompleted,\n    isExtendedListReviewed,\n    onComplete,\n    onRemoveCustomApp,\n  } = useSecurityFeedbackModal({ url, safeAppManifest, safeApp: getSafeApp(url), addPermissions, getPermissions })\n\n  const goBack = useCallback(() => history.goBack(), [history])\n\n  if (isSafeAppListLoading || isSafeAppManifestLoading) {\n    return <div />\n  }\n\n  if (url) {\n    if (isModalVisible) {\n      return (\n        <SecurityFeedbackModal\n          onCancel={goBack}\n          onConfirm={onComplete}\n          appUrl={url}\n          features={safeAppManifest.safeAppsPermissions || []}\n          isConsentAccepted={isConsentAccepted}\n          isSafeAppInDefaultList={isSafeAppInDefaultList}\n          isFirstTimeAccessingApp={isFirstTimeAccessingApp}\n          isExtendedListReviewed={isExtendedListReviewed}\n          isPermissionsReviewCompleted={isPermissionsReviewCompleted}\n        />\n      )\n    }\n\n    return (\n      <SafeAppsErrorBoundary render={() => <SafeAppsLoadError />}>\n        <AppFrame appUrl={url} allowedFeaturesList={getAllowedFeaturesList(url)} />\n      </SafeAppsErrorBoundary>\n    )\n  } else {\n    return <AppsList onRemoveApp={onRemoveCustomApp} />\n  }\n}\n\nexport default Apps\n"],"sourceRoot":""}